{
  "hash": "65d42b1bc8a51e796ab0e8e5e4679a47",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Linear Regressions with Python\"\nauthor: \"Paulo Gugelmo Cavalheiro Dias\"\ndate: 07/05/2024\ncategories:\n - python\n - statistics\nengine: python3\ndraft: false\n---\n\n\n\nIn this article, I will try to do linear regressions with Python. \nThis is also an occasion for me to try Python with Quarto. \n\n# 1. Quarto configuration for Python\n\nThis section is dedicated to using Python with [Quarto](https://quarto.org), since this website was done using Quarto (if you want to know more about it, you can check [their documentation here](https://quarto.org/docs/websites/) and [this project of mine](https://www.paulogcd.com/portfolio_tutorial/)).\nIf you do not use Quarto, you can just skip this section. \n\nThe Quarto Markdown format (with the .qmd extension) allows to embed code and text, formatted with Markdown.\nTo work with Python code in Quarto, we first have to use an engine that supports Python. \nFor that, we can use `python3` or `jupyter` for examples. \nThus, in our `YAML` header, we would enter : \n\n```{.yaml}\n---\nengine: python3\n# or : \nengine: jupyter\n---\n```\n\nWe can check our engines with quarto with the command `quarto check`. \nThis function is designed to \"verify [the] correct functioning of Quarto installation\" (from its description in documentation).\nRunning it returns the versions of different kernels that we can use.\n\nFinally, to include python code in our Quarto file, we can write : \n\n````\n```{{python}}\n# Some python code here\n```\n````\n\nFor example : \n\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Getting the version of Python we are using : \nimport sys \nsys.version_info\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nsys.version_info(major=3, minor=12, micro=4, releaselevel='final', serial=0)\n```\n\n\n:::\n:::\n\n\n\nHere, we are for example using Python 3.12.\n\n## 1.1. Running Julia and R in the same document \n\nDepending on the engine we are using, we can also make use of other languages in the same Quarto document. \nSpecifying the `python3` engine in the `YAML` header of our Quarto document, we can run Julia and R in it.\nFor that, we need packages, such as `JuliaCall` for using Julia with R.\n\nTesting Julia yields : \n\n\n::: {.cell}\n\n```{.julia .cell-code}\n# Getting the version of Julia we are using : \nusing InteractiveUtils\nInteractiveUtils.versioninfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nJulia Version 1.10.3\nCommit 0b4590a550 (2024-04-30 10:59 UTC)\nBuild Info:\n  Built by Homebrew (v1.10.3)\n\n    Note: This is an unofficial build, please report bugs to the project\n    responsible for this build and not to the Julia project unless you can\n    reproduce the issue using official builds available at https://julialang.org/downloads\n\nPlatform Info:\n  OS: macOS (arm64-apple-darwin23.4.0)\n  CPU: 8 Ã— Apple M1\n  WORD_SIZE: 64\n  LIBM: libopenlibm\n  LLVM: libLLVM-15.0.7 (ORCJIT, apple-m1)\nThreads: 1 default, 0 interactive, 1 GC (on 4 virtual cores)\nEnvironment:\n  DYLD_FALLBACK_LIBRARY_PATH = /Library/Frameworks/R.framework/Resources/lib:/Library/Java/JavaVirtualMachines/jdk-11.0.18+10/Contents/Home/lib/server\n```\n\n\n:::\n:::\n\n\n\nTesting R yields : \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Getting the version of R we are using : \nversion\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               _                           \nplatform       aarch64-apple-darwin20      \narch           aarch64                     \nos             darwin20                    \nsystem         aarch64, darwin20           \nstatus                                     \nmajor          4                           \nminor          4.0                         \nyear           2024                        \nmonth          04                          \nday            24                          \nsvn rev        86474                       \nlanguage       R                           \nversion.string R version 4.4.0 (2024-04-24)\nnickname       Puppy Cup                   \n```\n\n\n:::\n:::\n\n\n\nSince the rest of the article will exclusively be using Python, we will not mention further details of engines in Quarto.\nIt is however interesting to keep in mind that Quarto allows this multiple integration.\n\n# 2. Simple linear regression\n\nThis section of the article treats how to do a simple linear regression with Python. \nWe will first generate random data, we will plot it, and we will then add the linear regression to our plot. \n\n## 2.1. Generating data\n\nI found two main libraries to generate random data in Python. \nThe first one is the `random` library, and the second one is the `numpy` library.\n\nWith the random library, we can use the `random` method to generate by default a float number between 0 and 1. \nA way to create a vector of 100 random values is to use the `random` method between square brackets, followed by the `for` instruction, similar to the one in Julia. \nThis will generate a list of size fixed, such that : \n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport random\ny = ([random.random() for _ in range(100)])\nx = ([random.random()*y[_] for _ in range(100)])\n```\n:::\n\n\n\nLet us comment a bit this code : \n\n- It is possible to call methods with the name of their libraries in front of it.\nIn this sense, `random.random()` refers to the method `random()` inside the `random` library.\n- The underscore syntax `_` combined with `for` loops to iterated for a set number of times. \nBy default, the `_` symbol just refers to the last variable in memory of Python, but it can also be used like that. \n- The `range()` function allows to create a range object in Python. More specifically : \n\n> [It] return[s] an object that produces a sequence of integers from start (inclusive) to stop (exclusive) by step.\nRange(i, j) produces i, i+1, i+2, ..., j-1. Start defaults to 0, and stop is omitted!  range(4) produces 0, 1, 2, 3.\nThese are exactly the valid indices for a list of 4 elements.\nWhen step is given, it specifies the increment (or decrement).\n\nA second way of generating random data is using the numpy library. \nFor that, we use the `numpy.random.rand()` method : \n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport numpy\nnumpy.random.rand(100)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\narray([0.00592745, 0.75294248, 0.94689826, 0.47642028, 0.11962005,\n       0.52470106, 0.60702635, 0.15253373, 0.53457452, 0.38565149,\n       0.64664118, 0.52782941, 0.1863171 , 0.62393744, 0.47887005,\n       0.51752405, 0.6082846 , 0.94538496, 0.15588617, 0.93843073,\n       0.71304326, 0.91281546, 0.15744652, 0.65390069, 0.90430497,\n       0.02007971, 0.90876743, 0.7371541 , 0.13214819, 0.77117829,\n       0.41983029, 0.42378729, 0.68161776, 0.77530917, 0.10258949,\n       0.64014087, 0.92515723, 0.81516093, 0.32943734, 0.88071784,\n       0.45455588, 0.66861511, 0.82865439, 0.56225488, 0.9957281 ,\n       0.52904564, 0.47166687, 0.88949489, 0.45428736, 0.97020451,\n       0.99314305, 0.67423413, 0.56184371, 0.41641916, 0.54561917,\n       0.93896844, 0.09701167, 0.62007889, 0.87678115, 0.39321745,\n       0.9872945 , 0.97044126, 0.54605077, 0.51073665, 0.00533591,\n       0.97947303, 0.23759523, 0.22853751, 0.13700576, 0.9933836 ,\n       0.82715814, 0.56069471, 0.58494474, 0.93326851, 0.97248153,\n       0.90951482, 0.02044552, 0.01536296, 0.09132653, 0.31115691,\n       0.3089081 , 0.24117981, 0.42406074, 0.77607162, 0.07922152,\n       0.43397369, 0.36773676, 0.91578712, 0.4391219 , 0.46481153,\n       0.84583504, 0.11902362, 0.97803419, 0.98239256, 0.39096067,\n       0.39562847, 0.69702822, 0.84916839, 0.85820585, 0.07123363])\n```\n\n\n:::\n:::\n\n\n\nHere, the `numpy.random.rand()` method also generates a random real number between 0 and 1. \nWe are going to stick with the first x variable created for the rest of the section.\n\n## 2.2. Plotting the data\n\nNow that we generated some data, let us plot it.\nTo do that, we can use the [matplotlib library](https://matplotlib.org/). \nMore specifically, we are going to use pyplot inside matplotlib, and are thus going to import `matplotlib.pyplot` :\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport matplotlib.pyplot\nmatplotlib.pyplot.scatter(x,y)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n- The `scatter()` method of `matplotlib.pyplot` allows to plot a scatterplot with two vectors of the same size.\n\n> The `scatter()` \"method\" can also be considered as a function.\nThis distinction seems to also exist in other programming languages and is definitely worth understanding. \nFor the sake of linear regressions, it does not matter for now to develop a full understanding of this distinction.\nIn the rest of this article, we will thus stick to the \"method\" term without further explanation. \n\n## 2.3. Fitting our model\n\nWe are now going to fit our statistical model with our randomly generated values. \nIn order for us to do that, we can use the `scipy.stats` library.\nThis library has a `linregress()` method that allows to compute the OLS estimates to explain the second variable with the first one : \n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport scipy\nmodel = scipy.stats.linregress(x,y)\nmodel\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLinregressResult(slope=np.float64(0.8383718326044476), intercept=np.float64(0.30883317915377173), rvalue=np.float64(0.6159824384646858), pvalue=np.float64(9.024229215374189e-12), stderr=np.float64(0.10830516572266864), intercept_stderr=np.float64(0.03237551409033611))\n```\n\n\n:::\n:::\n\n\n\nWe see that the `scipy.stats.linregress()` method returns a five elements object.\nTo make this method easier to use, we could generate five variables, define a function with those variables and plot a line based on this function : \n\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# We define the five variables from the linregress() method :\nslope, intercept, r, p, std_err = scipy.stats.linregress(x, y)\n\n# We define a function returning a linear function with the slope and the intercept :\ndef myfunc(x):\n  return slope * x + intercept\n\n# We create a list object with the list() function that takes as an argument a map object, based on our function and on the variable x :\nmymodel = list(map(myfunc, x))\nmymodel\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[np.float64(0.3466552962850944), np.float64(0.4855711228389237), np.float64(0.9147031170175356), np.float64(0.5153160299254063), np.float64(0.3801609990790563), np.float64(0.6044597742873725), np.float64(0.8592707674606043), np.float64(0.36509600545338833), np.float64(0.5527195718240848), np.float64(0.5240474317193224), np.float64(0.6014795199237659), np.float64(0.42070431481441095), np.float64(0.3281109864632415), np.float64(0.609338479700958), np.float64(0.5272774936883462), np.float64(0.49793336361061025), np.float64(0.6615576168832237), np.float64(0.48558369820808656), np.float64(0.682856174322561), np.float64(0.7340434195846064), np.float64(0.5627113232349656), np.float64(0.32278236816126854), np.float64(0.5929799171046213), np.float64(0.35278841098901403), np.float64(0.3580677536604607), np.float64(0.42191435405309263), np.float64(0.3238418122945764), np.float64(0.3191886742819142), np.float64(0.3568292775067544), np.float64(0.32757438236782), np.float64(0.32671680069225056), np.float64(0.42326584087775343), np.float64(0.3301253898513797), np.float64(0.49109681714494313), np.float64(0.44458311312708415), np.float64(0.5199585587348523), np.float64(0.9186022591677041), np.float64(0.39114282592853183), np.float64(0.4014183383452378), np.float64(0.4877972869989182), np.float64(0.3266773853988873), np.float64(0.4588845589667885), np.float64(0.5815321192975246), np.float64(0.5075743754991987), np.float64(0.46377760017945563), np.float64(0.3574396105070033), np.float64(0.39249417206726944), np.float64(0.488752927533466), np.float64(0.35569069788803687), np.float64(0.49822895229055497), np.float64(0.5161923540876256), np.float64(0.5088533951852636), np.float64(0.769034375640042), np.float64(0.6326334342149869), np.float64(1.0423321590360448), np.float64(0.3296848512011278), np.float64(0.3707922844586858), np.float64(0.4266797387634848), np.float64(0.33652341146276105), np.float64(0.39743971330310107), np.float64(0.3336311390693917), np.float64(0.5564567995066856), np.float64(0.376091444906386), np.float64(0.45090231896434735), np.float64(0.5040838302265498), np.float64(0.4051622523445217), np.float64(0.3226383239044324), np.float64(0.33191401608324494), np.float64(0.4666930634968537), np.float64(0.570707699127708), np.float64(0.5617582353940804), np.float64(0.3124068143973404), np.float64(0.5292769029282633), np.float64(0.3203018487632795), np.float64(0.7373582721485279), np.float64(0.36890927811192537), np.float64(0.5325929851471497), np.float64(0.6323717424690725), np.float64(0.932503917572861), np.float64(0.33708525383560667), np.float64(0.6526942091151531), np.float64(0.35715817364214664), np.float64(1.015109148788574), np.float64(0.32887962550451877), np.float64(0.7060221022682294), np.float64(0.339489680159918), np.float64(0.6722012746136157), np.float64(0.7056671726580602), np.float64(0.745471258289146), np.float64(0.4308133963682357), np.float64(0.33121240452941486), np.float64(0.37579615641214226), np.float64(0.40511754269860345), np.float64(0.40202405377269135), np.float64(0.7391566857584171), np.float64(0.5956863712448213), np.float64(0.4803225716002546), np.float64(0.3907379210536772), np.float64(0.4214984627624902), np.float64(0.3109604583787798)]\n```\n\n\n:::\n:::\n\n\n\nThe definition of the variable `mymodel` is worth explaning a bit more in details.\nThe `list()` function is used to create a `list` object (which is considered one of the most versatile objects in Python), like the `c()` function creates a vector in R.\nThe `map()` function returns a map object, defined as : \n\n> map(func, *iterables) --> map object\nMake an iterator that computes the function using arguments from each of the iterables.  Stops when the shortest iterable is exhausted.\n\nin the Python documentation. \n\nNow, if we want to add this line to our plot, we can run : \n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nmatplotlib.pyplot.scatter(x,y)\nmatplotlib.pyplot.plot(x, mymodel)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-3.png){width=672}\n:::\n:::\n\n\n\nWhile it is curious that the variable mymodel is displayed as a continuous line, it works, so I am fine with this solution for now.\n\nIf we want only the more relevant information, we can choose to only work with the two first elements of the array, and plot it, we can do in a more concise way :\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\ndef f(x):\n    return scipy.stats.linregress(x, y)[1]+numpy.dot(x,scipy.stats.linregress(x, y)[0])\n\nfloat(scipy.stats.linregress(x, y)[1]),float(scipy.stats.linregress(x, y)[0])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n(0.30883317915377173, 0.8383718326044476)\n```\n\n\n:::\n\n```{.python .cell-code}\nmatplotlib.pyplot.scatter(x,y)\nmatplotlib.pyplot.plot(x, f(x))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-5.png){width=672}\n:::\n:::\n\n\n\nWe note here that we are using the `numpy.dot()` method from the `numpy` library. \nThis method allows us to do the dot product of two different matrixes.\nIn our case, doing only `x * scipy.stats.linregress(x,y)[0]` would have returned an error, since `x` and the other term are not of the same dimension.\nThis method thus allows to avoid this error by vectorizing the multiplication. \n\nNow that we covered a how to perform a simple linear regression with Python, let us move to a multiple linear regression.\n\n# 3. Multiple linear regression\n\nIn this section, we are going to perform a multiple linear regression. \nFirst, we are going to generate data and fit our model.\nThen, we will plot a static scatter plot, and finally a 3D rotatable plot.\n\n## 3.1. Running a multiple linear regression\n\nFirst, let us generate some random data and fit our model. \n\nTo generate random data, we can do : \n\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# We randomly generate four variables of length 100 :\nw,x,y,z = (numpy.dot([random.random() for _ in range(100)],_) for _ in (1,2,3,4))\n# Just to check the length : \nlen(y)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n100\n```\n\n\n:::\n:::\n\n\n\nTo run a multinomial linear regression that satisfies the OLS equation, we could use several libraries. \nLet us say that we want to explain the `z` variable by x and y.\n\n### 3.1.1. The sklearn library\n\nOne approach that seems to be widely used is to use the `sklearn` library. \nMore specifically, we could use the `sklearn.linear_model` package :  \n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport sklearn.linear_model\n\n# We create an object that regroups x, y and w :\nregressors = numpy.column_stack((x,y,w))\n\n# We create the object 'model' that has the LinearRegression() class from the sklearn.linear_model package : \nmodel = sklearn.linear_model.LinearRegression()\n \n# Fit the model to the data\nmodel.fit(regressors, z)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<style>#sk-container-id-1 {\n  /* Definition of color scheme common for light and dark mode */\n  --sklearn-color-text: black;\n  --sklearn-color-line: gray;\n  /* Definition of color scheme for unfitted estimators */\n  --sklearn-color-unfitted-level-0: #fff5e6;\n  --sklearn-color-unfitted-level-1: #f6e4d2;\n  --sklearn-color-unfitted-level-2: #ffe0b3;\n  --sklearn-color-unfitted-level-3: chocolate;\n  /* Definition of color scheme for fitted estimators */\n  --sklearn-color-fitted-level-0: #f0f8ff;\n  --sklearn-color-fitted-level-1: #d4ebff;\n  --sklearn-color-fitted-level-2: #b3dbfd;\n  --sklearn-color-fitted-level-3: cornflowerblue;\n\n  /* Specific color for light theme */\n  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));\n  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n  --sklearn-color-icon: #696969;\n\n  @media (prefers-color-scheme: dark) {\n    /* Redefinition of color scheme for dark theme */\n    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));\n    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n    --sklearn-color-icon: #878787;\n  }\n}\n\n#sk-container-id-1 {\n  color: var(--sklearn-color-text);\n}\n\n#sk-container-id-1 pre {\n  padding: 0;\n}\n\n#sk-container-id-1 input.sk-hidden--visually {\n  border: 0;\n  clip: rect(1px 1px 1px 1px);\n  clip: rect(1px, 1px, 1px, 1px);\n  height: 1px;\n  margin: -1px;\n  overflow: hidden;\n  padding: 0;\n  position: absolute;\n  width: 1px;\n}\n\n#sk-container-id-1 div.sk-dashed-wrapped {\n  border: 1px dashed var(--sklearn-color-line);\n  margin: 0 0.4em 0.5em 0.4em;\n  box-sizing: border-box;\n  padding-bottom: 0.4em;\n  background-color: var(--sklearn-color-background);\n}\n\n#sk-container-id-1 div.sk-container {\n  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`\n     but bootstrap.min.css set `[hidden] { display: none !important; }`\n     so we also need the `!important` here to be able to override the\n     default hidden behavior on the sphinx rendered scikit-learn.org.\n     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */\n  display: inline-block !important;\n  position: relative;\n}\n\n#sk-container-id-1 div.sk-text-repr-fallback {\n  display: none;\n}\n\ndiv.sk-parallel-item,\ndiv.sk-serial,\ndiv.sk-item {\n  /* draw centered vertical line to link estimators */\n  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));\n  background-size: 2px 100%;\n  background-repeat: no-repeat;\n  background-position: center center;\n}\n\n/* Parallel-specific style estimator block */\n\n#sk-container-id-1 div.sk-parallel-item::after {\n  content: \"\";\n  width: 100%;\n  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);\n  flex-grow: 1;\n}\n\n#sk-container-id-1 div.sk-parallel {\n  display: flex;\n  align-items: stretch;\n  justify-content: center;\n  background-color: var(--sklearn-color-background);\n  position: relative;\n}\n\n#sk-container-id-1 div.sk-parallel-item {\n  display: flex;\n  flex-direction: column;\n}\n\n#sk-container-id-1 div.sk-parallel-item:first-child::after {\n  align-self: flex-end;\n  width: 50%;\n}\n\n#sk-container-id-1 div.sk-parallel-item:last-child::after {\n  align-self: flex-start;\n  width: 50%;\n}\n\n#sk-container-id-1 div.sk-parallel-item:only-child::after {\n  width: 0;\n}\n\n/* Serial-specific style estimator block */\n\n#sk-container-id-1 div.sk-serial {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  background-color: var(--sklearn-color-background);\n  padding-right: 1em;\n  padding-left: 1em;\n}\n\n\n/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is\nclickable and can be expanded/collapsed.\n- Pipeline and ColumnTransformer use this feature and define the default style\n- Estimators will overwrite some part of the style using the `sk-estimator` class\n*/\n\n/* Pipeline and ColumnTransformer style (default) */\n\n#sk-container-id-1 div.sk-toggleable {\n  /* Default theme specific background. It is overwritten whether we have a\n  specific estimator or a Pipeline/ColumnTransformer */\n  background-color: var(--sklearn-color-background);\n}\n\n/* Toggleable label */\n#sk-container-id-1 label.sk-toggleable__label {\n  cursor: pointer;\n  display: block;\n  width: 100%;\n  margin-bottom: 0;\n  padding: 0.5em;\n  box-sizing: border-box;\n  text-align: center;\n}\n\n#sk-container-id-1 label.sk-toggleable__label-arrow:before {\n  /* Arrow on the left of the label */\n  content: \"â–¸\";\n  float: left;\n  margin-right: 0.25em;\n  color: var(--sklearn-color-icon);\n}\n\n#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {\n  color: var(--sklearn-color-text);\n}\n\n/* Toggleable content - dropdown */\n\n#sk-container-id-1 div.sk-toggleable__content {\n  max-height: 0;\n  max-width: 0;\n  overflow: hidden;\n  text-align: left;\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-0);\n}\n\n#sk-container-id-1 div.sk-toggleable__content.fitted {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-0);\n}\n\n#sk-container-id-1 div.sk-toggleable__content pre {\n  margin: 0.2em;\n  border-radius: 0.25em;\n  color: var(--sklearn-color-text);\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-0);\n}\n\n#sk-container-id-1 div.sk-toggleable__content.fitted pre {\n  /* unfitted */\n  background-color: var(--sklearn-color-fitted-level-0);\n}\n\n#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {\n  /* Expand drop-down */\n  max-height: 200px;\n  max-width: 100%;\n  overflow: auto;\n}\n\n#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {\n  content: \"â–¾\";\n}\n\n/* Pipeline/ColumnTransformer-specific style */\n\n#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  color: var(--sklearn-color-text);\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n/* Estimator-specific style */\n\n/* Colorize estimator box */\n#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n#sk-container-id-1 div.sk-label label.sk-toggleable__label,\n#sk-container-id-1 div.sk-label label {\n  /* The background is the default theme color */\n  color: var(--sklearn-color-text-on-default-background);\n}\n\n/* On hover, darken the color of the background */\n#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {\n  color: var(--sklearn-color-text);\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n/* Label box, darken color on hover, fitted */\n#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {\n  color: var(--sklearn-color-text);\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n/* Estimator label */\n\n#sk-container-id-1 div.sk-label label {\n  font-family: monospace;\n  font-weight: bold;\n  display: inline-block;\n  line-height: 1.2em;\n}\n\n#sk-container-id-1 div.sk-label-container {\n  text-align: center;\n}\n\n/* Estimator-specific */\n#sk-container-id-1 div.sk-estimator {\n  font-family: monospace;\n  border: 1px dotted var(--sklearn-color-border-box);\n  border-radius: 0.25em;\n  box-sizing: border-box;\n  margin-bottom: 0.5em;\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-0);\n}\n\n#sk-container-id-1 div.sk-estimator.fitted {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-0);\n}\n\n/* on hover */\n#sk-container-id-1 div.sk-estimator:hover {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n#sk-container-id-1 div.sk-estimator.fitted:hover {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n/* Specification for estimator info (e.g. \"i\" and \"?\") */\n\n/* Common style for \"i\" and \"?\" */\n\n.sk-estimator-doc-link,\na:link.sk-estimator-doc-link,\na:visited.sk-estimator-doc-link {\n  float: right;\n  font-size: smaller;\n  line-height: 1em;\n  font-family: monospace;\n  background-color: var(--sklearn-color-background);\n  border-radius: 1em;\n  height: 1em;\n  width: 1em;\n  text-decoration: none !important;\n  margin-left: 1ex;\n  /* unfitted */\n  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n  color: var(--sklearn-color-unfitted-level-1);\n}\n\n.sk-estimator-doc-link.fitted,\na:link.sk-estimator-doc-link.fitted,\na:visited.sk-estimator-doc-link.fitted {\n  /* fitted */\n  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n  color: var(--sklearn-color-fitted-level-1);\n}\n\n/* On hover */\ndiv.sk-estimator:hover .sk-estimator-doc-link:hover,\n.sk-estimator-doc-link:hover,\ndiv.sk-label-container:hover .sk-estimator-doc-link:hover,\n.sk-estimator-doc-link:hover {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-3);\n  color: var(--sklearn-color-background);\n  text-decoration: none;\n}\n\ndiv.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,\n.sk-estimator-doc-link.fitted:hover,\ndiv.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,\n.sk-estimator-doc-link.fitted:hover {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-3);\n  color: var(--sklearn-color-background);\n  text-decoration: none;\n}\n\n/* Span, style for the box shown on hovering the info icon */\n.sk-estimator-doc-link span {\n  display: none;\n  z-index: 9999;\n  position: relative;\n  font-weight: normal;\n  right: .2ex;\n  padding: .5ex;\n  margin: .5ex;\n  width: min-content;\n  min-width: 20ex;\n  max-width: 50ex;\n  color: var(--sklearn-color-text);\n  box-shadow: 2pt 2pt 4pt #999;\n  /* unfitted */\n  background: var(--sklearn-color-unfitted-level-0);\n  border: .5pt solid var(--sklearn-color-unfitted-level-3);\n}\n\n.sk-estimator-doc-link.fitted span {\n  /* fitted */\n  background: var(--sklearn-color-fitted-level-0);\n  border: var(--sklearn-color-fitted-level-3);\n}\n\n.sk-estimator-doc-link:hover span {\n  display: block;\n}\n\n/* \"?\"-specific style due to the `<a>` HTML tag */\n\n#sk-container-id-1 a.estimator_doc_link {\n  float: right;\n  font-size: 1rem;\n  line-height: 1em;\n  font-family: monospace;\n  background-color: var(--sklearn-color-background);\n  border-radius: 1rem;\n  height: 1rem;\n  width: 1rem;\n  text-decoration: none;\n  /* unfitted */\n  color: var(--sklearn-color-unfitted-level-1);\n  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n}\n\n#sk-container-id-1 a.estimator_doc_link.fitted {\n  /* fitted */\n  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n  color: var(--sklearn-color-fitted-level-1);\n}\n\n/* On hover */\n#sk-container-id-1 a.estimator_doc_link:hover {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-3);\n  color: var(--sklearn-color-background);\n  text-decoration: none;\n}\n\n#sk-container-id-1 a.estimator_doc_link.fitted:hover {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-3);\n}\n</style><div id=\"sk-container-id-1\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>LinearRegression()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-1\" type=\"checkbox\" checked><label for=\"sk-estimator-id-1\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow fitted\">&nbsp;&nbsp;LinearRegression<a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.5/modules/generated/sklearn.linear_model.LinearRegression.html\">?<span>Documentation for LinearRegression</span></a><span class=\"sk-estimator-doc-link fitted\">i<span>Fitted</span></span></label><div class=\"sk-toggleable__content fitted\"><pre>LinearRegression()</pre></div> </div></div></div></div>\n```\n\n:::\n\n```{.python .cell-code}\nmodel.coef_\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\narray([0.02372518, 0.22686716, 0.08769466])\n```\n\n\n:::\n\n```{.python .cell-code}\nmodel.intercept_\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nnp.float64(1.5537197507494207)\n```\n\n\n:::\n:::\n\n\n\nThe model.intercept_ value is the intercept of z, and the coefficients are consistent with the regressors object. \nThe first one corresponds to the effect of x, the second to the effect of y, and the last one to the effect of w. \n\n### 3.1.2. The statsmodels library\n\nTo get a nicer display and final object, we can alternatively use the statsmodels library.\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport statsmodels.api\n\n# Create the object and specify an intercept :\nregressors = statsmodels.api.add_constant(regressors)\nmodel = statsmodels.api.OLS(z,regressors)\n\n# Run the model :\nresults = model.fit()\n\n# Print the regression table : \nprint(results.summary())\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                            OLS Regression Results                            \n==============================================================================\nDep. Variable:                      y   R-squared:                       0.030\nModel:                            OLS   Adj. R-squared:                 -0.000\nMethod:                 Least Squares   F-statistic:                    0.9966\nDate:                Fri, 05 Jul 2024   Prob (F-statistic):              0.398\nTime:                        14:07:22   Log-Likelihood:                -152.78\nNo. Observations:                 100   AIC:                             313.6\nDf Residuals:                      96   BIC:                             324.0\nDf Model:                           3                                         \nCovariance Type:            nonrobust                                         \n==============================================================================\n                 coef    std err          t      P>|t|      [0.025      0.975]\n------------------------------------------------------------------------------\nconst          1.5537      0.358      4.342      0.000       0.843       2.264\nx1             0.0237      0.202      0.118      0.907      -0.377       0.424\nx2             0.2269      0.135      1.684      0.095      -0.041       0.494\nx3             0.0877      0.400      0.219      0.827      -0.706       0.881\n==============================================================================\nOmnibus:                       17.960   Durbin-Watson:                   2.031\nProb(Omnibus):                  0.000   Jarque-Bera (JB):                5.139\nSkew:                           0.179   Prob(JB):                       0.0766\nKurtosis:                       1.949   Cond. No.                         9.43\n==============================================================================\n\nNotes:\n[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n```\n\n\n:::\n:::\n\n\n\nWe can also access to the itnercept and the coefficients directly, by doing : \n\n\n::: {.cell}\n\n```{.python .cell-code}\nresults.params\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\narray([1.55371975, 0.02372518, 0.22686716, 0.08769466])\n```\n\n\n:::\n:::\n\n\n\n## 3.2. Plotting a static 3D plot\n\nIf we now want to limit ourselves to a four dimensional problem, we can plot 3D graphs with colors representing the fourth dimension. \nIn this section, we are first going to plot a static graph. \n\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# We first create the framework of a plot, that we name \"figure\" : \nfigure = matplotlib.pyplot.figure()\n\n# In this figure, we are going to use the add_subplot method to create a three dimensional projection : \nprojection = figure.add_subplot(projection='3d')\n\n# In this three dimensional space, we are going to project our points in a scatterplot way.\n# The argument 'c' stands for the color of the points :\nprojection.scatter(x,y,z, c = w)\n\n# Finally, we give each of our axis a name : \nprojection.set_xlabel(\"X\")\nprojection.set_ylabel(\"Y\")\nprojection.set_zlabel(\"Z\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-15-7.png){width=672}\n:::\n:::\n\n\n\nThe syntax of this example can be a bit hard to understand at first, but is required when using `matplotlib.pyplot` library.\n\n## 3.3. Plotting a rotatable 3D plot \n\nNow it's time for a rotatable plot, like in the previous article. \nFortunately, the plotly library does also exist for Python, which is great, because I did not find any other library that yielded a similar result. \nHowever, to use plotly, we need the pandas library.  \nWe can thus create a dataframe object from a dictionary with the four previously created vectors. \nIf we only want to display a 3D scatter plot, we can run : \n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport plotly.express\nimport pandas\n\n# We create a four columns dataframe with our four previously generated vectors : \ndata = {'c1':[x],'c2':[y],'c3':[z],'c4':[w]}\nX = pandas.DataFrame(data)\n\nfig = plotly.express.scatter_3d(X, x,y,z, color=w)\nfig.show()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div>                        <script type=\"text/javascript\">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>\n        <script charset=\"utf-8\" src=\"https://cdn.plot.ly/plotly-2.32.0.min.js\"></script>                <div id=\"fd348174-fc47-4a55-9aa2-e687a1bbc4d3\" class=\"plotly-graph-div\" style=\"height:100%; width:100%;\"></div>            <script type=\"text/javascript\">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"fd348174-fc47-4a55-9aa2-e687a1bbc4d3\")) {                    Plotly.newPlot(                        \"fd348174-fc47-4a55-9aa2-e687a1bbc4d3\",                        [{\"hovertemplate\":\"x=%{x}\\u003cbr\\u003ey=%{y}\\u003cbr\\u003ez=%{z}\\u003cbr\\u003ecolor=%{marker.color}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"\",\"marker\":{\"color\":[0.3451886700592903,0.7350169774962059,0.4624456326191767,0.7476828620333067,0.8740841699875966,0.07330430870761484,0.23037300329187493,0.669909137660676,0.08494745002661108,0.17227806220350217,0.599749962528758,0.26008112973960507,0.4104483197543841,0.7892318946933292,0.39343377145178005,0.07067025503192537,0.2818784610419677,0.6569178262847509,0.7322960882013007,0.36259456156528536,0.9644437212365516,0.33187859739085235,0.7095827240972956,0.3822357362121709,0.5178732330363008,0.029504441568692474,0.6851273480415079,0.28999840679656286,0.02175843789377052,0.615186693138266,0.8636824226222274,0.996059473435776,0.7004583539810744,0.11258376335302978,0.8776928107049319,0.789355483986041,0.1327140442803958,0.43428934199026314,0.2579127219623225,0.4405788684508777,0.6980580817083364,0.5192346780663568,0.7094118827088477,0.3749953365430978,0.07318842570797368,0.28137954146598576,0.467800000432934,0.4867870796725181,0.009528479439991466,0.4481838544738639,0.030535508917252985,0.6451087110208991,0.5212822154492732,0.3986496499912322,0.5040627381134143,0.942261508199455,0.8617252362163118,0.6724237626167421,0.7865724725768426,0.6066061816463911,0.1328927887095649,0.0019088805213182125,0.8087924854095342,0.2574822525396222,0.7978541929855284,0.6630616495750022,0.5983114760884795,0.8713733394839444,0.38489635363036745,0.005729167152786041,0.9628828885913533,0.11224493161560822,0.6328277941612479,0.12460176906846332,0.26306987435970053,0.9566013510403271,0.9949360965122527,0.6913332340390329,0.3236118226716337,0.03368340108971479,0.9555238115604253,0.6454385222568559,0.9779879681411243,0.7421170115385747,0.5165308783574201,0.6688279771349305,0.4961570335481307,0.8016010288084479,0.8042394346739689,0.9461775273824682,0.8730857184956039,0.35676465878951613,0.2784422251395188,0.7068140021123264,0.1511950305342078,0.7185421339068846,0.6435294670163465,0.3498686919876647,0.5344565599281287,0.5170621202842032],\"coloraxis\":\"coloraxis\",\"symbol\":\"circle\"},\"mode\":\"markers\",\"name\":\"\",\"scene\":\"scene\",\"showlegend\":false,\"x\":[0.7039786158996293,1.1247575999221666,1.3644546831949365,0.8585044762329996,0.016555542207250085,0.894487906216282,1.8366608257206738,0.5705844600445928,1.0309551955389045,0.7862231480664867,1.150300383977197,1.7701299292521873,0.2918894647201318,1.50627668909069,0.21170934314951517,1.530399761520989,0.48874204870054294,0.9094567394513122,0.17184605824400023,0.3490825663069428,1.558723914012818,1.0119219184262567,0.9188258355789993,1.7641667162487336,1.0444838949881365,1.6493634726379618,1.4541700537301374,1.500356753595541,0.3658786929834963,0.43055530082748317,1.4903459271684847,1.9609977982712594,1.445668097474075,1.248713324323314,1.3252511322472116,1.3148270186433224,0.052976885227498105,0.17884447509642376,1.6996646669210205,0.2745996379577127,0.05961415713807994,0.8851093046217562,0.4433058143349857,1.6104168532925967,1.5944953429751643,0.3959975677935672,1.687519076890779,1.43501093800638,1.4999065869878696,0.7485132049823933,0.3491734166354947,0.969283522034686,0.729159908135552,1.1647141419635236,0.9135499067326216,0.2425380816097935,0.10690895324367955,1.9975773439368036,0.7312201835406786,0.30570045381183886,0.9418479542210145,1.2934030984762903,1.7835377840204327,0.4158773951135506,1.3256158863775245,1.636484307323454,1.0613626294968008,1.682271541202124,0.9657252818176898,1.8486416283879523,1.1253557622156036,0.9808138393330976,1.6573685444317359,1.9650805411244714,0.28414563105892654,1.5763178342120716,1.4497622954045026,0.8930467681592076,0.5374027016772693,0.6965842641169255,1.9548505735508988,1.1534674164045216,1.2469701542252996,0.49382455567363603,1.055322388173255,0.0990780661833095,1.3874345364796385,1.9361439503609805,1.415086755844581,0.7005127242265308,0.5191669414680933,0.20638142311964147,0.01362277355092889,1.4684109854052232,0.10827439040188613,0.8336776646248563,0.8312286355942904,1.7746160586071573,1.0202057789333012,1.6631707696521192],\"y\":[0.6581133687560407,0.2059598232872073,1.5280305509488628,2.4871106043375466,1.2652188810718408,2.125893217440301,0.5814695299801603,1.4894887781517099,2.0009352699348004,0.3670353483678307,2.410090115833614,0.1412826380617237,1.3149407609160813,1.5289687535837337,1.637080361872421,2.6576350608335466,0.8508828803207267,2.0236931149032653,2.3727197364146284,0.8668200940665954,0.6946335201727509,1.5481314715002363,0.10303740099780812,2.3692343317537032,1.0314886715754112,1.831380775969921,1.0133434687636702,1.0225419996345562,2.9821540561802333,0.7956029945819754,2.131442811555226,1.552616716661591,0.8487266630397305,0.4212607574481225,2.680275378033593,1.9092352937513275,2.83912241791462,1.871628344636691,1.30424138509437,0.13093092999077782,2.8866090512451543,0.0316244814052169,0.00319075466345764,2.395396791448474,1.5845385799585245,2.356273708307439,2.524309237436822,2.2952110793211595,0.14615716019149727,1.3098200140154996,2.5836560251258254,1.310452795006415,0.6951255969324737,2.2521173388049447,0.46915196084414335,0.32803266143588106,2.4478213134133813,2.4792660715416477,1.0097240418264253,1.8632680356243765,1.725551150123823,1.3126476552582422,2.572983084782658,0.7697709200573989,0.7197906342389929,1.086759086125526,2.9559455229862173,2.2993094805557472,0.29817569306293035,2.5067548664372064,1.1090883528341293,0.013890433172187189,2.9761082670043253,2.3143781993829333,2.3578696480618344,2.573260295195329,2.134417800508438,1.8880682110255897,1.597892137010322,0.29919925828474114,2.7738315461604506,1.9153675286161704,0.8443302923249117,1.7639077356413144,1.2130255843146458,2.6106451330996476,1.477271469547314,0.3034169926997329,1.6479076349234725,2.010228959502956,2.568121009538471,1.542800987018965,1.736401580348672,1.4946839966333338,1.6913963264322187,2.8351955949755925,1.8334733068882647,1.0532831126092401,2.9138886865672613,1.8348297328463075],\"z\":[3.9746994338845263,1.1531041767321297,3.7721257209044965,3.435725247704429,1.4849809624882644,0.8433808165620937,3.0187295215858265,0.1731870890741889,3.439531465024207,1.3676933895943493,2.0842314448875126,0.8072929445506918,0.09398464960547814,0.34124063750473166,2.65454018895203,1.4978724286733942,1.8462251990454517,1.8104147700048885,2.763236213989999,1.0454161791695467,1.7368864152531902,1.1339833505147126,0.8151931553503373,2.6467422019594244,0.9323809948193373,2.187681259410715,3.2615462770693044,1.0402024282464035,2.2824776291609217,0.023878826392072394,0.5827139618554664,3.767642368288164,0.6014478627301405,1.1190644384366042,3.589770880827844,2.5415275713127468,3.6851720812514333,0.6925986816461163,3.7282635719756807,0.029543983896792803,3.5336941842500944,3.2909891542329124,1.3341723041293,0.8763723963607184,2.261595201743707,2.511648973398692,2.244033784326215,1.0679302038876548,0.04585347815300045,1.2416666541272767,1.9288523128790511,2.459559013636839,3.4301298041395833,2.7628269643512375,2.209297949384515,3.5596869506073285,2.5788763576313816,1.694518918683463,0.9237878419714609,1.1485029415920809,0.753432727347529,3.627018256183013,1.11644059266838,3.683643938150912,2.1881934283986553,3.278642558410879,3.041058790587814,2.848978738421647,0.9786632484930919,1.7741992321252966,1.3756070057083059,2.0515483061608877,3.304907575965217,2.6573674526690385,0.9204442065559317,1.4565265831948317,1.1104947001758814,3.969279923550669,1.1928395855510776,1.318255403856471,0.17584747626631625,2.2953749796641514,1.7904500016861533,3.76144964238721,3.5144509714959424,3.457763661964542,0.5559599026990543,1.829685337081849,3.4192528139456453,2.2216861697268833,0.6860118969296578,0.9912445697156014,2.3416461714357357,0.3530963409796768,0.7768459467184923,1.6899623485325184,3.8146479630528694,2.369911176133034,1.6884249494194834,2.6921695340336247],\"type\":\"scatter3d\"}],                        {\"template\":{\"data\":{\"histogram2dcontour\":[{\"type\":\"histogram2dcontour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"choropleth\":[{\"type\":\"choropleth\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"histogram2d\":[{\"type\":\"histogram2d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"heatmap\":[{\"type\":\"heatmap\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"heatmapgl\":[{\"type\":\"heatmapgl\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"contourcarpet\":[{\"type\":\"contourcarpet\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"contour\":[{\"type\":\"contour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"surface\":[{\"type\":\"surface\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"mesh3d\":[{\"type\":\"mesh3d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"parcoords\":[{\"type\":\"parcoords\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolargl\":[{\"type\":\"scatterpolargl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"scattergeo\":[{\"type\":\"scattergeo\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolar\":[{\"type\":\"scatterpolar\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"scattergl\":[{\"type\":\"scattergl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatter3d\":[{\"type\":\"scatter3d\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermapbox\":[{\"type\":\"scattermapbox\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterternary\":[{\"type\":\"scatterternary\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattercarpet\":[{\"type\":\"scattercarpet\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}],\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}]},\"layout\":{\"autotypenumbers\":\"strict\",\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"hovermode\":\"closest\",\"hoverlabel\":{\"align\":\"left\"},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"#E5ECF6\",\"polar\":{\"bgcolor\":\"#E5ECF6\",\"angularaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"radialaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"ternary\":{\"bgcolor\":\"#E5ECF6\",\"aaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"caxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]]},\"xaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"yaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"yaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"zaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"geo\":{\"bgcolor\":\"white\",\"landcolor\":\"#E5ECF6\",\"subunitcolor\":\"white\",\"showland\":true,\"showlakes\":true,\"lakecolor\":\"white\"},\"title\":{\"x\":0.05},\"mapbox\":{\"style\":\"light\"}}},\"scene\":{\"domain\":{\"x\":[0.0,1.0],\"y\":[0.0,1.0]},\"xaxis\":{\"title\":{\"text\":\"x\"}},\"yaxis\":{\"title\":{\"text\":\"y\"}},\"zaxis\":{\"title\":{\"text\":\"z\"}}},\"coloraxis\":{\"colorbar\":{\"title\":{\"text\":\"color\"}},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"legend\":{\"tracegroupgap\":0},\"margin\":{\"t\":60}},                        {\"responsive\": true}                    )                };                            </script>        </div>\n```\n\n:::\n:::\n\n\n\nWe note that this yields a plot with similar features to the ones obtained in [the previous article with Julia](https://www.paulogcd.com/blog/posts/1_regressions_julia/). \nThe reason for that is that both obtained plots are done using the plotly library. \n\nFor the rest of the section, we are going to limit ourselves to only two regressands, excluding the w variable, since the display will be easier to understand this way : \n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nX = numpy.column_stack((x,y))\nX = statsmodels.api.add_constant(X)\nmodel = statsmodels.api.OLS(z,X)\nresults = model.fit()\nprint(results.summary())\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                            OLS Regression Results                            \n==============================================================================\nDep. Variable:                      y   R-squared:                       0.030\nModel:                            OLS   Adj. R-squared:                  0.010\nMethod:                 Least Squares   F-statistic:                     1.485\nDate:                Fri, 05 Jul 2024   Prob (F-statistic):              0.232\nTime:                        14:07:23   Log-Likelihood:                -152.81\nNo. Observations:                 100   AIC:                             311.6\nDf Residuals:                      97   BIC:                             319.4\nDf Model:                           2                                         \nCovariance Type:            nonrobust                                         \n==============================================================================\n                 coef    std err          t      P>|t|      [0.025      0.975]\n------------------------------------------------------------------------------\nconst          1.5915      0.312      5.099      0.000       0.972       2.211\nx1             0.0273      0.200      0.136      0.892      -0.370       0.425\nx2             0.2292      0.134      1.715      0.090      -0.036       0.494\n==============================================================================\nOmnibus:                       18.620   Durbin-Watson:                   2.015\nProb(Omnibus):                  0.000   Jarque-Bera (JB):                5.252\nSkew:                           0.186   Prob(JB):                       0.0724\nKurtosis:                       1.941   Cond. No.                         6.97\n==============================================================================\n\nNotes:\n[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n```\n\n\n:::\n:::\n\n\n\nNow, we need more lines to plot a surface. \nMore specifically, we are going to use plotly.graph_objects and make use of the meshgrid method : \n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport plotly.graph_objects\n\n# We first store the information of our regression : \nintercept, coef1, coef2 = results.params\n\n# We then create meshgrids for x,y, and z : \nx_range = numpy.linspace(x.min(), x.max(), 10)\ny_range = numpy.linspace(y.min(), y.max(), 10)\nx_grid, y_grid = numpy.meshgrid(x_range, y_range)\nz_grid = intercept + coef1 * x_grid + coef2 * y_grid\n\n# We now generate a surface object with the grids we just created\nsurface = plotly.graph_objects.Surface(\n    x=x_grid, y=y_grid, z=z_grid,\n    colorscale='Viridis', opacity=0.5\n)\n\n# We create a scatter object, to be able to plot it with the surface :\nscatter = plotly.graph_objects.Scatter3d(\n    x=x, y=y, z=z,\n    mode='markers',\n    marker=dict(size=5, color=w, colorscale='Viridis')\n)\n\n# We create a figure object, with the scatter and surface tha we just generated : \nfig = plotly.graph_objects.Figure(data = [scatter, surface])\n\n# We display the figure : \nfig.show()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div>                        <script type=\"text/javascript\">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>\n        <script charset=\"utf-8\" src=\"https://cdn.plot.ly/plotly-2.32.0.min.js\"></script>                <div id=\"d4b9b0db-982e-4c49-a5b0-82ca44c9989f\" class=\"plotly-graph-div\" style=\"height:100%; width:100%;\"></div>            <script type=\"text/javascript\">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"d4b9b0db-982e-4c49-a5b0-82ca44c9989f\")) {                    Plotly.newPlot(                        \"d4b9b0db-982e-4c49-a5b0-82ca44c9989f\",                        [{\"marker\":{\"color\":[0.3451886700592903,0.7350169774962059,0.4624456326191767,0.7476828620333067,0.8740841699875966,0.07330430870761484,0.23037300329187493,0.669909137660676,0.08494745002661108,0.17227806220350217,0.599749962528758,0.26008112973960507,0.4104483197543841,0.7892318946933292,0.39343377145178005,0.07067025503192537,0.2818784610419677,0.6569178262847509,0.7322960882013007,0.36259456156528536,0.9644437212365516,0.33187859739085235,0.7095827240972956,0.3822357362121709,0.5178732330363008,0.029504441568692474,0.6851273480415079,0.28999840679656286,0.02175843789377052,0.615186693138266,0.8636824226222274,0.996059473435776,0.7004583539810744,0.11258376335302978,0.8776928107049319,0.789355483986041,0.1327140442803958,0.43428934199026314,0.2579127219623225,0.4405788684508777,0.6980580817083364,0.5192346780663568,0.7094118827088477,0.3749953365430978,0.07318842570797368,0.28137954146598576,0.467800000432934,0.4867870796725181,0.009528479439991466,0.4481838544738639,0.030535508917252985,0.6451087110208991,0.5212822154492732,0.3986496499912322,0.5040627381134143,0.942261508199455,0.8617252362163118,0.6724237626167421,0.7865724725768426,0.6066061816463911,0.1328927887095649,0.0019088805213182125,0.8087924854095342,0.2574822525396222,0.7978541929855284,0.6630616495750022,0.5983114760884795,0.8713733394839444,0.38489635363036745,0.005729167152786041,0.9628828885913533,0.11224493161560822,0.6328277941612479,0.12460176906846332,0.26306987435970053,0.9566013510403271,0.9949360965122527,0.6913332340390329,0.3236118226716337,0.03368340108971479,0.9555238115604253,0.6454385222568559,0.9779879681411243,0.7421170115385747,0.5165308783574201,0.6688279771349305,0.4961570335481307,0.8016010288084479,0.8042394346739689,0.9461775273824682,0.8730857184956039,0.35676465878951613,0.2784422251395188,0.7068140021123264,0.1511950305342078,0.7185421339068846,0.6435294670163465,0.3498686919876647,0.5344565599281287,0.5170621202842032],\"colorscale\":[[0.0,\"#440154\"],[0.1111111111111111,\"#482878\"],[0.2222222222222222,\"#3e4989\"],[0.3333333333333333,\"#31688e\"],[0.4444444444444444,\"#26828e\"],[0.5555555555555556,\"#1f9e89\"],[0.6666666666666666,\"#35b779\"],[0.7777777777777778,\"#6ece58\"],[0.8888888888888888,\"#b5de2b\"],[1.0,\"#fde725\"]],\"size\":5},\"mode\":\"markers\",\"x\":[0.7039786158996293,1.1247575999221666,1.3644546831949365,0.8585044762329996,0.016555542207250085,0.894487906216282,1.8366608257206738,0.5705844600445928,1.0309551955389045,0.7862231480664867,1.150300383977197,1.7701299292521873,0.2918894647201318,1.50627668909069,0.21170934314951517,1.530399761520989,0.48874204870054294,0.9094567394513122,0.17184605824400023,0.3490825663069428,1.558723914012818,1.0119219184262567,0.9188258355789993,1.7641667162487336,1.0444838949881365,1.6493634726379618,1.4541700537301374,1.500356753595541,0.3658786929834963,0.43055530082748317,1.4903459271684847,1.9609977982712594,1.445668097474075,1.248713324323314,1.3252511322472116,1.3148270186433224,0.052976885227498105,0.17884447509642376,1.6996646669210205,0.2745996379577127,0.05961415713807994,0.8851093046217562,0.4433058143349857,1.6104168532925967,1.5944953429751643,0.3959975677935672,1.687519076890779,1.43501093800638,1.4999065869878696,0.7485132049823933,0.3491734166354947,0.969283522034686,0.729159908135552,1.1647141419635236,0.9135499067326216,0.2425380816097935,0.10690895324367955,1.9975773439368036,0.7312201835406786,0.30570045381183886,0.9418479542210145,1.2934030984762903,1.7835377840204327,0.4158773951135506,1.3256158863775245,1.636484307323454,1.0613626294968008,1.682271541202124,0.9657252818176898,1.8486416283879523,1.1253557622156036,0.9808138393330976,1.6573685444317359,1.9650805411244714,0.28414563105892654,1.5763178342120716,1.4497622954045026,0.8930467681592076,0.5374027016772693,0.6965842641169255,1.9548505735508988,1.1534674164045216,1.2469701542252996,0.49382455567363603,1.055322388173255,0.0990780661833095,1.3874345364796385,1.9361439503609805,1.415086755844581,0.7005127242265308,0.5191669414680933,0.20638142311964147,0.01362277355092889,1.4684109854052232,0.10827439040188613,0.8336776646248563,0.8312286355942904,1.7746160586071573,1.0202057789333012,1.6631707696521192],\"y\":[0.6581133687560407,0.2059598232872073,1.5280305509488628,2.4871106043375466,1.2652188810718408,2.125893217440301,0.5814695299801603,1.4894887781517099,2.0009352699348004,0.3670353483678307,2.410090115833614,0.1412826380617237,1.3149407609160813,1.5289687535837337,1.637080361872421,2.6576350608335466,0.8508828803207267,2.0236931149032653,2.3727197364146284,0.8668200940665954,0.6946335201727509,1.5481314715002363,0.10303740099780812,2.3692343317537032,1.0314886715754112,1.831380775969921,1.0133434687636702,1.0225419996345562,2.9821540561802333,0.7956029945819754,2.131442811555226,1.552616716661591,0.8487266630397305,0.4212607574481225,2.680275378033593,1.9092352937513275,2.83912241791462,1.871628344636691,1.30424138509437,0.13093092999077782,2.8866090512451543,0.0316244814052169,0.00319075466345764,2.395396791448474,1.5845385799585245,2.356273708307439,2.524309237436822,2.2952110793211595,0.14615716019149727,1.3098200140154996,2.5836560251258254,1.310452795006415,0.6951255969324737,2.2521173388049447,0.46915196084414335,0.32803266143588106,2.4478213134133813,2.4792660715416477,1.0097240418264253,1.8632680356243765,1.725551150123823,1.3126476552582422,2.572983084782658,0.7697709200573989,0.7197906342389929,1.086759086125526,2.9559455229862173,2.2993094805557472,0.29817569306293035,2.5067548664372064,1.1090883528341293,0.013890433172187189,2.9761082670043253,2.3143781993829333,2.3578696480618344,2.573260295195329,2.134417800508438,1.8880682110255897,1.597892137010322,0.29919925828474114,2.7738315461604506,1.9153675286161704,0.8443302923249117,1.7639077356413144,1.2130255843146458,2.6106451330996476,1.477271469547314,0.3034169926997329,1.6479076349234725,2.010228959502956,2.568121009538471,1.542800987018965,1.736401580348672,1.4946839966333338,1.6913963264322187,2.8351955949755925,1.8334733068882647,1.0532831126092401,2.9138886865672613,1.8348297328463075],\"z\":[3.9746994338845263,1.1531041767321297,3.7721257209044965,3.435725247704429,1.4849809624882644,0.8433808165620937,3.0187295215858265,0.1731870890741889,3.439531465024207,1.3676933895943493,2.0842314448875126,0.8072929445506918,0.09398464960547814,0.34124063750473166,2.65454018895203,1.4978724286733942,1.8462251990454517,1.8104147700048885,2.763236213989999,1.0454161791695467,1.7368864152531902,1.1339833505147126,0.8151931553503373,2.6467422019594244,0.9323809948193373,2.187681259410715,3.2615462770693044,1.0402024282464035,2.2824776291609217,0.023878826392072394,0.5827139618554664,3.767642368288164,0.6014478627301405,1.1190644384366042,3.589770880827844,2.5415275713127468,3.6851720812514333,0.6925986816461163,3.7282635719756807,0.029543983896792803,3.5336941842500944,3.2909891542329124,1.3341723041293,0.8763723963607184,2.261595201743707,2.511648973398692,2.244033784326215,1.0679302038876548,0.04585347815300045,1.2416666541272767,1.9288523128790511,2.459559013636839,3.4301298041395833,2.7628269643512375,2.209297949384515,3.5596869506073285,2.5788763576313816,1.694518918683463,0.9237878419714609,1.1485029415920809,0.753432727347529,3.627018256183013,1.11644059266838,3.683643938150912,2.1881934283986553,3.278642558410879,3.041058790587814,2.848978738421647,0.9786632484930919,1.7741992321252966,1.3756070057083059,2.0515483061608877,3.304907575965217,2.6573674526690385,0.9204442065559317,1.4565265831948317,1.1104947001758814,3.969279923550669,1.1928395855510776,1.318255403856471,0.17584747626631625,2.2953749796641514,1.7904500016861533,3.76144964238721,3.5144509714959424,3.457763661964542,0.5559599026990543,1.829685337081849,3.4192528139456453,2.2216861697268833,0.6860118969296578,0.9912445697156014,2.3416461714357357,0.3530963409796768,0.7768459467184923,1.6899623485325184,3.8146479630528694,2.369911176133034,1.6884249494194834,2.6921695340336247],\"type\":\"scatter3d\"},{\"colorscale\":[[0.0,\"#440154\"],[0.1111111111111111,\"#482878\"],[0.2222222222222222,\"#3e4989\"],[0.3333333333333333,\"#31688e\"],[0.4444444444444444,\"#26828e\"],[0.5555555555555556,\"#1f9e89\"],[0.6666666666666666,\"#35b779\"],[0.7777777777777778,\"#6ece58\"],[0.8888888888888888,\"#b5de2b\"],[1.0,\"#fde725\"]],\"opacity\":0.5,\"x\":[[0.01362277355092889,0.23406217026047052,0.45450156697001215,0.6749409636795538,0.8953803603890954,1.115819757098637,1.3362591538081787,1.5566985505177202,1.777137947227262,1.9975773439368036],[0.01362277355092889,0.23406217026047052,0.45450156697001215,0.6749409636795538,0.8953803603890954,1.115819757098637,1.3362591538081787,1.5566985505177202,1.777137947227262,1.9975773439368036],[0.01362277355092889,0.23406217026047052,0.45450156697001215,0.6749409636795538,0.8953803603890954,1.115819757098637,1.3362591538081787,1.5566985505177202,1.777137947227262,1.9975773439368036],[0.01362277355092889,0.23406217026047052,0.45450156697001215,0.6749409636795538,0.8953803603890954,1.115819757098637,1.3362591538081787,1.5566985505177202,1.777137947227262,1.9975773439368036],[0.01362277355092889,0.23406217026047052,0.45450156697001215,0.6749409636795538,0.8953803603890954,1.115819757098637,1.3362591538081787,1.5566985505177202,1.777137947227262,1.9975773439368036],[0.01362277355092889,0.23406217026047052,0.45450156697001215,0.6749409636795538,0.8953803603890954,1.115819757098637,1.3362591538081787,1.5566985505177202,1.777137947227262,1.9975773439368036],[0.01362277355092889,0.23406217026047052,0.45450156697001215,0.6749409636795538,0.8953803603890954,1.115819757098637,1.3362591538081787,1.5566985505177202,1.777137947227262,1.9975773439368036],[0.01362277355092889,0.23406217026047052,0.45450156697001215,0.6749409636795538,0.8953803603890954,1.115819757098637,1.3362591538081787,1.5566985505177202,1.777137947227262,1.9975773439368036],[0.01362277355092889,0.23406217026047052,0.45450156697001215,0.6749409636795538,0.8953803603890954,1.115819757098637,1.3362591538081787,1.5566985505177202,1.777137947227262,1.9975773439368036],[0.01362277355092889,0.23406217026047052,0.45450156697001215,0.6749409636795538,0.8953803603890954,1.115819757098637,1.3362591538081787,1.5566985505177202,1.777137947227262,1.9975773439368036]],\"y\":[[0.00319075466345764,0.00319075466345764,0.00319075466345764,0.00319075466345764,0.00319075466345764,0.00319075466345764,0.00319075466345764,0.00319075466345764,0.00319075466345764,0.00319075466345764],[0.3341866770542105,0.3341866770542105,0.3341866770542105,0.3341866770542105,0.3341866770542105,0.3341866770542105,0.3341866770542105,0.3341866770542105,0.3341866770542105,0.3341866770542105],[0.6651825994449634,0.6651825994449634,0.6651825994449634,0.6651825994449634,0.6651825994449634,0.6651825994449634,0.6651825994449634,0.6651825994449634,0.6651825994449634,0.6651825994449634],[0.9961785218357163,0.9961785218357163,0.9961785218357163,0.9961785218357163,0.9961785218357163,0.9961785218357163,0.9961785218357163,0.9961785218357163,0.9961785218357163,0.9961785218357163],[1.3271744442264692,1.3271744442264692,1.3271744442264692,1.3271744442264692,1.3271744442264692,1.3271744442264692,1.3271744442264692,1.3271744442264692,1.3271744442264692,1.3271744442264692],[1.658170366617222,1.658170366617222,1.658170366617222,1.658170366617222,1.658170366617222,1.658170366617222,1.658170366617222,1.658170366617222,1.658170366617222,1.658170366617222],[1.9891662890079749,1.9891662890079749,1.9891662890079749,1.9891662890079749,1.9891662890079749,1.9891662890079749,1.9891662890079749,1.9891662890079749,1.9891662890079749,1.9891662890079749],[2.3201622113987277,2.3201622113987277,2.3201622113987277,2.3201622113987277,2.3201622113987277,2.3201622113987277,2.3201622113987277,2.3201622113987277,2.3201622113987277,2.3201622113987277],[2.6511581337894805,2.6511581337894805,2.6511581337894805,2.6511581337894805,2.6511581337894805,2.6511581337894805,2.6511581337894805,2.6511581337894805,2.6511581337894805,2.6511581337894805],[2.9821540561802333,2.9821540561802333,2.9821540561802333,2.9821540561802333,2.9821540561802333,2.9821540561802333,2.9821540561802333,2.9821540561802333,2.9821540561802333,2.9821540561802333]],\"z\":[[1.5926178447050627,1.598629839103751,1.604641833502439,1.6106538279011273,1.6166658222998154,1.6226778166985036,1.6286898110971917,1.63470180549588,1.640713799894568,1.6467257942932563],[1.6684836959058822,1.6744956903045705,1.6805076847032585,1.6865196791019468,1.6925316735006348,1.698543667899323,1.7045556622980111,1.7105676566966994,1.7165796510953875,1.7225916454940757],[1.7443495471067014,1.7503615415053897,1.7563735359040777,1.762385530302766,1.768397524701454,1.7744095191001423,1.7804215134988304,1.7864335078975186,1.7924455022962067,1.798457496694895],[1.8202153983075209,1.8262273927062092,1.8322393871048972,1.8382513815035855,1.8442633759022735,1.8502753703009618,1.8562873646996498,1.862299359098338,1.8683113534970262,1.8743233478957144],[1.8960812495083401,1.9020932439070284,1.9081052383057164,1.9141172327044047,1.9201292271030928,1.926141221501781,1.932153215900469,1.9381652102991573,1.9441772046978454,1.9501891990965337],[1.9719471007091596,1.9779590951078478,1.983971089506536,1.9899830839052242,1.9959950783039122,2.0020070727026003,2.0080190671012885,2.014031061499977,2.0200430558986646,2.026055050297353],[2.047812951909979,2.053824946308667,2.0598369407073553,2.0658489351060436,2.0718609295047314,2.0778729239034197,2.083884918302108,2.0898969127007962,2.095908907099484,2.1019209014981723],[2.1236788031107983,2.1296907975094865,2.1357027919081744,2.1417147863068626,2.147726780705551,2.153738775104239,2.159750769502927,2.1657627639016153,2.1717747583003035,2.177786752698992],[2.1995446543116177,2.2055566487103055,2.211568643108994,2.217580637507682,2.22359263190637,2.2296046263050586,2.2356166207037464,2.2416286151024347,2.247640609501123,2.253652603899811],[2.2754105055124367,2.281422499911125,2.2874344943098133,2.2934464887085015,2.2994584831071894,2.3054704775058776,2.311482471904566,2.317494466303254,2.323506460701942,2.3295184551006303]],\"type\":\"surface\"}],                        {\"template\":{\"data\":{\"histogram2dcontour\":[{\"type\":\"histogram2dcontour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"choropleth\":[{\"type\":\"choropleth\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"histogram2d\":[{\"type\":\"histogram2d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"heatmap\":[{\"type\":\"heatmap\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"heatmapgl\":[{\"type\":\"heatmapgl\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"contourcarpet\":[{\"type\":\"contourcarpet\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"contour\":[{\"type\":\"contour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"surface\":[{\"type\":\"surface\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"mesh3d\":[{\"type\":\"mesh3d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"parcoords\":[{\"type\":\"parcoords\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolargl\":[{\"type\":\"scatterpolargl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"scattergeo\":[{\"type\":\"scattergeo\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolar\":[{\"type\":\"scatterpolar\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"scattergl\":[{\"type\":\"scattergl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatter3d\":[{\"type\":\"scatter3d\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermapbox\":[{\"type\":\"scattermapbox\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterternary\":[{\"type\":\"scatterternary\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattercarpet\":[{\"type\":\"scattercarpet\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}],\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}]},\"layout\":{\"autotypenumbers\":\"strict\",\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"hovermode\":\"closest\",\"hoverlabel\":{\"align\":\"left\"},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"#E5ECF6\",\"polar\":{\"bgcolor\":\"#E5ECF6\",\"angularaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"radialaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"ternary\":{\"bgcolor\":\"#E5ECF6\",\"aaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"caxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]]},\"xaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"yaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"yaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"zaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"geo\":{\"bgcolor\":\"white\",\"landcolor\":\"#E5ECF6\",\"subunitcolor\":\"white\",\"showland\":true,\"showlakes\":true,\"lakecolor\":\"white\"},\"title\":{\"x\":0.05},\"mapbox\":{\"style\":\"light\"}}}},                        {\"responsive\": true}                    )                };                            </script>        </div>\n```\n\n:::\n:::\n\n\n\nThis looks satisfactory. \nI even manage to plot the points with the surface of the regression in the 3D plot. \n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}