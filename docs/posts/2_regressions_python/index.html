<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.47">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Paulo Gugelmo Cavalheiro Dias">
<meta name="dcterms.date" content="2024-07-05">

<title>Linear Regressions with Python – My Blog</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../projects"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../contact.html"> 
<span class="menu-text">Contact</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/Paulogcd/blog">
            Source Code
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/Paulogcd/blog/issues">
            Report a Bug
            </a>
          </li>
      </ul>
    </div>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#quarto-configuration-for-python" id="toc-quarto-configuration-for-python" class="nav-link active" data-scroll-target="#quarto-configuration-for-python">1. Quarto configuration for Python</a>
  <ul class="collapse">
  <li><a href="#running-julia-and-r-in-the-same-document" id="toc-running-julia-and-r-in-the-same-document" class="nav-link" data-scroll-target="#running-julia-and-r-in-the-same-document">1.1. Running Julia and R in the same document</a></li>
  </ul></li>
  <li><a href="#simple-linear-regression" id="toc-simple-linear-regression" class="nav-link" data-scroll-target="#simple-linear-regression">2. Simple linear regression</a>
  <ul class="collapse">
  <li><a href="#generating-data" id="toc-generating-data" class="nav-link" data-scroll-target="#generating-data">2.1. Generating data</a></li>
  <li><a href="#plotting-the-data" id="toc-plotting-the-data" class="nav-link" data-scroll-target="#plotting-the-data">2.2. Plotting the data</a></li>
  <li><a href="#fitting-our-model" id="toc-fitting-our-model" class="nav-link" data-scroll-target="#fitting-our-model">2.3. Fitting our model</a></li>
  </ul></li>
  <li><a href="#multiple-linear-regression" id="toc-multiple-linear-regression" class="nav-link" data-scroll-target="#multiple-linear-regression">3. Multiple linear regression</a>
  <ul class="collapse">
  <li><a href="#running-a-multiple-linear-regression" id="toc-running-a-multiple-linear-regression" class="nav-link" data-scroll-target="#running-a-multiple-linear-regression">3.1. Running a multiple linear regression</a>
  <ul class="collapse">
  <li><a href="#the-sklearn-library" id="toc-the-sklearn-library" class="nav-link" data-scroll-target="#the-sklearn-library">3.1.1. The sklearn library</a></li>
  <li><a href="#the-statsmodels-library" id="toc-the-statsmodels-library" class="nav-link" data-scroll-target="#the-statsmodels-library">3.1.2. The statsmodels library</a></li>
  </ul></li>
  <li><a href="#plotting-a-static-3d-plot" id="toc-plotting-a-static-3d-plot" class="nav-link" data-scroll-target="#plotting-a-static-3d-plot">3.2. Plotting a static 3D plot</a></li>
  <li><a href="#plotting-a-rotatable-3d-plot" id="toc-plotting-a-rotatable-3d-plot" class="nav-link" data-scroll-target="#plotting-a-rotatable-3d-plot">3.3. Plotting a rotatable 3D plot</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Linear Regressions with Python</h1>
  <div class="quarto-categories">
    <div class="quarto-category">python</div>
    <div class="quarto-category">statistics</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Paulo Gugelmo Cavalheiro Dias </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">July 5, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>In this article, I will try to do linear regressions with Python. This is also an occasion for me to try Python with Quarto.</p>
<section id="quarto-configuration-for-python" class="level1">
<h1>1. Quarto configuration for Python</h1>
<p>This section is dedicated to using Python with <a href="https://quarto.org">Quarto</a>, since this website was done using Quarto (if you want to know more about it, you can check <a href="https://quarto.org/docs/websites/">their documentation here</a> and <a href="https://www.paulogcd.com/portfolio_tutorial/">this project of mine</a>). If you do not use Quarto, you can just skip this section.</p>
<p>The Quarto Markdown format (with the .qmd extension) allows to embed code and text, formatted with Markdown. To work with Python code in Quarto, we first have to use an engine that supports Python. For that, we can use <code>python3</code> or <code>jupyter</code> for examples. Thus, in our <code>YAML</code> header, we would enter :</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">engine</span><span class="kw">:</span><span class="at"> python3</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># or : </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">engine</span><span class="kw">:</span><span class="at"> jupyter</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>We can check our engines with quarto with the command <code>quarto check</code>. This function is designed to “verify [the] correct functioning of Quarto installation” (from its description in documentation). Running it returns the versions of different kernels that we can use.</p>
<p>Finally, to include python code in our Quarto file, we can write :</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="in"># Some python code here</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For example :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting the version of Python we are using : </span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>sys.version_info</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>sys.version_info(major=3, minor=12, micro=4, releaselevel='final', serial=0)</code></pre>
</div>
</div>
<p>Here, we are for example using Python 3.12.</p>
<section id="running-julia-and-r-in-the-same-document" class="level2">
<h2 class="anchored" data-anchor-id="running-julia-and-r-in-the-same-document">1.1. Running Julia and R in the same document</h2>
<p>Depending on the engine we are using, we can also make use of other languages in the same Quarto document. Specifying the <code>python3</code> engine in the <code>YAML</code> header of our Quarto document, we can run Julia and R in it. For that, we need packages, such as <code>JuliaCall</code> for using Julia with R.</p>
<p>Testing Julia yields :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting the version of Julia we are using : </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">InteractiveUtils</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="bu">InteractiveUtils</span>.<span class="fu">versioninfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Julia Version 1.10.3
Commit 0b4590a550 (2024-04-30 10:59 UTC)
Build Info:
  Built by Homebrew (v1.10.3)

    Note: This is an unofficial build, please report bugs to the project
    responsible for this build and not to the Julia project unless you can
    reproduce the issue using official builds available at https://julialang.org/downloads

Platform Info:
  OS: macOS (arm64-apple-darwin23.4.0)
  CPU: 8 × Apple M1
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-15.0.7 (ORCJIT, apple-m1)
Threads: 1 default, 0 interactive, 1 GC (on 4 virtual cores)
Environment:
  DYLD_FALLBACK_LIBRARY_PATH = /Library/Frameworks/R.framework/Resources/lib:/Library/Java/JavaVirtualMachines/jdk-11.0.18+10/Contents/Home/lib/server</code></pre>
</div>
</div>
<p>Testing R yields :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting the version of R we are using : </span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>version</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               _                           
platform       aarch64-apple-darwin20      
arch           aarch64                     
os             darwin20                    
system         aarch64, darwin20           
status                                     
major          4                           
minor          4.0                         
year           2024                        
month          04                          
day            24                          
svn rev        86474                       
language       R                           
version.string R version 4.4.0 (2024-04-24)
nickname       Puppy Cup                   </code></pre>
</div>
</div>
<p>Since the rest of the article will exclusively be using Python, we will not mention further details of engines in Quarto. It is however interesting to keep in mind that Quarto allows this multiple integration.</p>
</section>
</section>
<section id="simple-linear-regression" class="level1">
<h1>2. Simple linear regression</h1>
<p>This section of the article treats how to do a simple linear regression with Python. We will first generate random data, we will plot it, and we will then add the linear regression to our plot.</p>
<section id="generating-data" class="level2">
<h2 class="anchored" data-anchor-id="generating-data">2.1. Generating data</h2>
<p>I found two main libraries to generate random data in Python. The first one is the <code>random</code> library, and the second one is the <code>numpy</code> library.</p>
<p>With the random library, we can use the <code>random</code> method to generate by default a float number between 0 and 1. A way to create a vector of 100 random values is to use the <code>random</code> method between square brackets, followed by the <code>for</code> instruction, similar to the one in Julia. This will generate a list of size fixed, such that :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> ([random.random() <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100</span>)])</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> ([random.random()<span class="op">*</span>y[_] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us comment a bit this code :</p>
<ul>
<li>It is possible to call methods with the name of their libraries in front of it. In this sense, <code>random.random()</code> refers to the method <code>random()</code> inside the <code>random</code> library.</li>
<li>The underscore syntax <code>_</code> combined with <code>for</code> loops to iterated for a set number of times. By default, the <code>_</code> symbol just refers to the last variable in memory of Python, but it can also be used like that.</li>
<li>The <code>range()</code> function allows to create a range object in Python. More specifically :</li>
</ul>
<blockquote class="blockquote">
<p>[It] return[s] an object that produces a sequence of integers from start (inclusive) to stop (exclusive) by step. Range(i, j) produces i, i+1, i+2, …, j-1. Start defaults to 0, and stop is omitted! range(4) produces 0, 1, 2, 3. These are exactly the valid indices for a list of 4 elements. When step is given, it specifies the increment (or decrement).</p>
</blockquote>
<p>A second way of generating random data is using the numpy library. For that, we use the <code>numpy.random.rand()</code> method :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>numpy.random.rand(<span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([0.00592745, 0.75294248, 0.94689826, 0.47642028, 0.11962005,
       0.52470106, 0.60702635, 0.15253373, 0.53457452, 0.38565149,
       0.64664118, 0.52782941, 0.1863171 , 0.62393744, 0.47887005,
       0.51752405, 0.6082846 , 0.94538496, 0.15588617, 0.93843073,
       0.71304326, 0.91281546, 0.15744652, 0.65390069, 0.90430497,
       0.02007971, 0.90876743, 0.7371541 , 0.13214819, 0.77117829,
       0.41983029, 0.42378729, 0.68161776, 0.77530917, 0.10258949,
       0.64014087, 0.92515723, 0.81516093, 0.32943734, 0.88071784,
       0.45455588, 0.66861511, 0.82865439, 0.56225488, 0.9957281 ,
       0.52904564, 0.47166687, 0.88949489, 0.45428736, 0.97020451,
       0.99314305, 0.67423413, 0.56184371, 0.41641916, 0.54561917,
       0.93896844, 0.09701167, 0.62007889, 0.87678115, 0.39321745,
       0.9872945 , 0.97044126, 0.54605077, 0.51073665, 0.00533591,
       0.97947303, 0.23759523, 0.22853751, 0.13700576, 0.9933836 ,
       0.82715814, 0.56069471, 0.58494474, 0.93326851, 0.97248153,
       0.90951482, 0.02044552, 0.01536296, 0.09132653, 0.31115691,
       0.3089081 , 0.24117981, 0.42406074, 0.77607162, 0.07922152,
       0.43397369, 0.36773676, 0.91578712, 0.4391219 , 0.46481153,
       0.84583504, 0.11902362, 0.97803419, 0.98239256, 0.39096067,
       0.39562847, 0.69702822, 0.84916839, 0.85820585, 0.07123363])</code></pre>
</div>
</div>
<p>Here, the <code>numpy.random.rand()</code> method also generates a random real number between 0 and 1. We are going to stick with the first x variable created for the rest of the section.</p>
</section>
<section id="plotting-the-data" class="level2">
<h2 class="anchored" data-anchor-id="plotting-the-data">2.2. Plotting the data</h2>
<p>Now that we generated some data, let us plot it. To do that, we can use the <a href="https://matplotlib.org/">matplotlib library</a>. More specifically, we are going to use pyplot inside matplotlib, and are thus going to import <code>matplotlib.pyplot</code> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>matplotlib.pyplot.scatter(x,y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>The <code>scatter()</code> method of <code>matplotlib.pyplot</code> allows to plot a scatterplot with two vectors of the same size.</li>
</ul>
<blockquote class="blockquote">
<p>The <code>scatter()</code> “method” can also be considered as a function. This distinction seems to also exist in other programming languages and is definitely worth understanding. For the sake of linear regressions, it does not matter for now to develop a full understanding of this distinction. In the rest of this article, we will thus stick to the “method” term without further explanation.</p>
</blockquote>
</section>
<section id="fitting-our-model" class="level2">
<h2 class="anchored" data-anchor-id="fitting-our-model">2.3. Fitting our model</h2>
<p>We are now going to fit our statistical model with our randomly generated values. In order for us to do that, we can use the <code>scipy.stats</code> library. This library has a <code>linregress()</code> method that allows to compute the OLS estimates to explain the second variable with the first one :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> scipy.stats.linregress(x,y)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>LinregressResult(slope=np.float64(0.8383718326044476), intercept=np.float64(0.30883317915377173), rvalue=np.float64(0.6159824384646858), pvalue=np.float64(9.024229215374189e-12), stderr=np.float64(0.10830516572266864), intercept_stderr=np.float64(0.03237551409033611))</code></pre>
</div>
</div>
<p>We see that the <code>scipy.stats.linregress()</code> method returns a five elements object. To make this method easier to use, we could generate five variables, define a function with those variables and plot a line based on this function :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We define the five variables from the linregress() method :</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>slope, intercept, r, p, std_err <span class="op">=</span> scipy.stats.linregress(x, y)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># We define a function returning a linear function with the slope and the intercept :</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> myfunc(x):</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> slope <span class="op">*</span> x <span class="op">+</span> intercept</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># We create a list object with the list() function that takes as an argument a map object, based on our function and on the variable x :</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>mymodel <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(myfunc, x))</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>mymodel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[np.float64(0.3466552962850944), np.float64(0.4855711228389237), np.float64(0.9147031170175356), np.float64(0.5153160299254063), np.float64(0.3801609990790563), np.float64(0.6044597742873725), np.float64(0.8592707674606043), np.float64(0.36509600545338833), np.float64(0.5527195718240848), np.float64(0.5240474317193224), np.float64(0.6014795199237659), np.float64(0.42070431481441095), np.float64(0.3281109864632415), np.float64(0.609338479700958), np.float64(0.5272774936883462), np.float64(0.49793336361061025), np.float64(0.6615576168832237), np.float64(0.48558369820808656), np.float64(0.682856174322561), np.float64(0.7340434195846064), np.float64(0.5627113232349656), np.float64(0.32278236816126854), np.float64(0.5929799171046213), np.float64(0.35278841098901403), np.float64(0.3580677536604607), np.float64(0.42191435405309263), np.float64(0.3238418122945764), np.float64(0.3191886742819142), np.float64(0.3568292775067544), np.float64(0.32757438236782), np.float64(0.32671680069225056), np.float64(0.42326584087775343), np.float64(0.3301253898513797), np.float64(0.49109681714494313), np.float64(0.44458311312708415), np.float64(0.5199585587348523), np.float64(0.9186022591677041), np.float64(0.39114282592853183), np.float64(0.4014183383452378), np.float64(0.4877972869989182), np.float64(0.3266773853988873), np.float64(0.4588845589667885), np.float64(0.5815321192975246), np.float64(0.5075743754991987), np.float64(0.46377760017945563), np.float64(0.3574396105070033), np.float64(0.39249417206726944), np.float64(0.488752927533466), np.float64(0.35569069788803687), np.float64(0.49822895229055497), np.float64(0.5161923540876256), np.float64(0.5088533951852636), np.float64(0.769034375640042), np.float64(0.6326334342149869), np.float64(1.0423321590360448), np.float64(0.3296848512011278), np.float64(0.3707922844586858), np.float64(0.4266797387634848), np.float64(0.33652341146276105), np.float64(0.39743971330310107), np.float64(0.3336311390693917), np.float64(0.5564567995066856), np.float64(0.376091444906386), np.float64(0.45090231896434735), np.float64(0.5040838302265498), np.float64(0.4051622523445217), np.float64(0.3226383239044324), np.float64(0.33191401608324494), np.float64(0.4666930634968537), np.float64(0.570707699127708), np.float64(0.5617582353940804), np.float64(0.3124068143973404), np.float64(0.5292769029282633), np.float64(0.3203018487632795), np.float64(0.7373582721485279), np.float64(0.36890927811192537), np.float64(0.5325929851471497), np.float64(0.6323717424690725), np.float64(0.932503917572861), np.float64(0.33708525383560667), np.float64(0.6526942091151531), np.float64(0.35715817364214664), np.float64(1.015109148788574), np.float64(0.32887962550451877), np.float64(0.7060221022682294), np.float64(0.339489680159918), np.float64(0.6722012746136157), np.float64(0.7056671726580602), np.float64(0.745471258289146), np.float64(0.4308133963682357), np.float64(0.33121240452941486), np.float64(0.37579615641214226), np.float64(0.40511754269860345), np.float64(0.40202405377269135), np.float64(0.7391566857584171), np.float64(0.5956863712448213), np.float64(0.4803225716002546), np.float64(0.3907379210536772), np.float64(0.4214984627624902), np.float64(0.3109604583787798)]</code></pre>
</div>
</div>
<p>The definition of the variable <code>mymodel</code> is worth explaning a bit more in details. The <code>list()</code> function is used to create a <code>list</code> object (which is considered one of the most versatile objects in Python), like the <code>c()</code> function creates a vector in R. The <code>map()</code> function returns a map object, defined as :</p>
<blockquote class="blockquote">
<p>map(func, *iterables) –&gt; map object Make an iterator that computes the function using arguments from each of the iterables. Stops when the shortest iterable is exhausted.</p>
</blockquote>
<p>in the Python documentation.</p>
<p>Now, if we want to add this line to our plot, we can run :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>matplotlib.pyplot.scatter(x,y)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>matplotlib.pyplot.plot(x, mymodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>While it is curious that the variable mymodel is displayed as a continuous line, it works, so I am fine with this solution for now.</p>
<p>If we want only the more relevant information, we can choose to only work with the two first elements of the array, and plot it, we can do in a more concise way :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x):</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> scipy.stats.linregress(x, y)[<span class="dv">1</span>]<span class="op">+</span>numpy.dot(x,scipy.stats.linregress(x, y)[<span class="dv">0</span>])</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="bu">float</span>(scipy.stats.linregress(x, y)[<span class="dv">1</span>]),<span class="bu">float</span>(scipy.stats.linregress(x, y)[<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(0.30883317915377173, 0.8383718326044476)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>matplotlib.pyplot.scatter(x,y)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>matplotlib.pyplot.plot(x, f(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-10-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We note here that we are using the <code>numpy.dot()</code> method from the <code>numpy</code> library. This method allows us to do the dot product of two different matrixes. In our case, doing only <code>x * scipy.stats.linregress(x,y)[0]</code> would have returned an error, since <code>x</code> and the other term are not of the same dimension. This method thus allows to avoid this error by vectorizing the multiplication.</p>
<p>Now that we covered a how to perform a simple linear regression with Python, let us move to a multiple linear regression.</p>
</section>
</section>
<section id="multiple-linear-regression" class="level1">
<h1>3. Multiple linear regression</h1>
<p>In this section, we are going to perform a multiple linear regression. First, we are going to generate data and fit our model. Then, we will plot a static scatter plot, and finally a 3D rotatable plot.</p>
<section id="running-a-multiple-linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="running-a-multiple-linear-regression">3.1. Running a multiple linear regression</h2>
<p>First, let us generate some random data and fit our model.</p>
<p>To generate random data, we can do :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We randomly generate four variables of length 100 :</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>w,x,y,z <span class="op">=</span> (numpy.dot([random.random() <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100</span>)],_) <span class="cf">for</span> _ <span class="kw">in</span> (<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Just to check the length : </span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>100</code></pre>
</div>
</div>
<p>To run a multinomial linear regression that satisfies the OLS equation, we could use several libraries. Let us say that we want to explain the <code>z</code> variable by x and y.</p>
<section id="the-sklearn-library" class="level3">
<h3 class="anchored" data-anchor-id="the-sklearn-library">3.1.1. The sklearn library</h3>
<p>One approach that seems to be widely used is to use the <code>sklearn</code> library. More specifically, we could use the <code>sklearn.linear_model</code> package :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sklearn.linear_model</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># We create an object that regroups x, y and w :</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>regressors <span class="op">=</span> numpy.column_stack((x,y,w))</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># We create the object 'model' that has the LinearRegression() class from the sklearn.linear_model package : </span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> sklearn.linear_model.LinearRegression()</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model to the data</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>model.fit(regressors, z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<style>#sk-container-id-1 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-1 {
  color: var(--sklearn-color-text);
}

#sk-container-id-1 pre {
  padding: 0;
}

#sk-container-id-1 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-1 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-1 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-1 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-1 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-1 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-1 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-1 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-1 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-1 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-1 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-1 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-1 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-1 div.sk-label label.sk-toggleable__label,
#sk-container-id-1 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-1 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-1 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-1 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-1 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-1 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-1 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-1 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-1 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</a></style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>LinearRegression()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked=""><label for="sk-estimator-id-1" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;LinearRegression<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.linear_model.LinearRegression.html">?<span>Documentation for LinearRegression</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>LinearRegression()</pre></div> </div></div></div></div>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>model.coef_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([0.02372518, 0.22686716, 0.08769466])</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>model.intercept_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>np.float64(1.5537197507494207)</code></pre>
</div>
</div>
<p>The model.intercept_ value is the intercept of z, and the coefficients are consistent with the regressors object. The first one corresponds to the effect of x, the second to the effect of y, and the last one to the effect of w.</p>
</section>
<section id="the-statsmodels-library" class="level3">
<h3 class="anchored" data-anchor-id="the-statsmodels-library">3.1.2. The statsmodels library</h3>
<p>To get a nicer display and final object, we can alternatively use the statsmodels library.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the object and specify an intercept :</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>regressors <span class="op">=</span> statsmodels.api.add_constant(regressors)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> statsmodels.api.OLS(z,regressors)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the model :</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> model.fit()</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the regression table : </span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(results.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                      y   R-squared:                       0.030
Model:                            OLS   Adj. R-squared:                 -0.000
Method:                 Least Squares   F-statistic:                    0.9966
Date:                Fri, 05 Jul 2024   Prob (F-statistic):              0.398
Time:                        14:07:22   Log-Likelihood:                -152.78
No. Observations:                 100   AIC:                             313.6
Df Residuals:                      96   BIC:                             324.0
Df Model:                           3                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
const          1.5537      0.358      4.342      0.000       0.843       2.264
x1             0.0237      0.202      0.118      0.907      -0.377       0.424
x2             0.2269      0.135      1.684      0.095      -0.041       0.494
x3             0.0877      0.400      0.219      0.827      -0.706       0.881
==============================================================================
Omnibus:                       17.960   Durbin-Watson:                   2.031
Prob(Omnibus):                  0.000   Jarque-Bera (JB):                5.139
Skew:                           0.179   Prob(JB):                       0.0766
Kurtosis:                       1.949   Cond. No.                         9.43
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</code></pre>
</div>
</div>
<p>We can also access to the itnercept and the coefficients directly, by doing :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>results.params</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([1.55371975, 0.02372518, 0.22686716, 0.08769466])</code></pre>
</div>
</div>
</section>
</section>
<section id="plotting-a-static-3d-plot" class="level2">
<h2 class="anchored" data-anchor-id="plotting-a-static-3d-plot">3.2. Plotting a static 3D plot</h2>
<p>If we now want to limit ourselves to a four dimensional problem, we can plot 3D graphs with colors representing the fourth dimension. In this section, we are first going to plot a static graph.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We first create the framework of a plot, that we name "figure" : </span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>figure <span class="op">=</span> matplotlib.pyplot.figure()</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># In this figure, we are going to use the add_subplot method to create a three dimensional projection : </span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>projection <span class="op">=</span> figure.add_subplot(projection<span class="op">=</span><span class="st">'3d'</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># In this three dimensional space, we are going to project our points in a scatterplot way.</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co"># The argument 'c' stands for the color of the points :</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>projection.scatter(x,y,z, c <span class="op">=</span> w)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Finally, we give each of our axis a name : </span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>projection.set_xlabel(<span class="st">"X"</span>)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>projection.set_ylabel(<span class="st">"Y"</span>)</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>projection.set_zlabel(<span class="st">"Z"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-15-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The syntax of this example can be a bit hard to understand at first, but is required when using <code>matplotlib.pyplot</code> library.</p>
</section>
<section id="plotting-a-rotatable-3d-plot" class="level2">
<h2 class="anchored" data-anchor-id="plotting-a-rotatable-3d-plot">3.3. Plotting a rotatable 3D plot</h2>
<p>Now it’s time for a rotatable plot, like in the previous article. Fortunately, the plotly library does also exist for Python, which is great, because I did not find any other library that yielded a similar result. However, to use plotly, we need the pandas library.<br>
We can thus create a dataframe object from a dictionary with the four previously created vectors. If we only want to display a 3D scatter plot, we can run :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># We create a four columns dataframe with our four previously generated vectors : </span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {<span class="st">'c1'</span>:[x],<span class="st">'c2'</span>:[y],<span class="st">'c3'</span>:[z],<span class="st">'c4'</span>:[w]}</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> pandas.DataFrame(data)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plotly.express.scatter_3d(X, x,y,z, color<span class="op">=</span>w)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>                <div id="fd348174-fc47-4a55-9aa2-e687a1bbc4d3" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("fd348174-fc47-4a55-9aa2-e687a1bbc4d3")) {                    Plotly.newPlot(                        "fd348174-fc47-4a55-9aa2-e687a1bbc4d3",                        [{"hovertemplate":"x=%{x}\u003cbr\u003ey=%{y}\u003cbr\u003ez=%{z}\u003cbr\u003ecolor=%{marker.color}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","marker":{"color":[0.3451886700592903,0.7350169774962059,0.4624456326191767,0.7476828620333067,0.8740841699875966,0.07330430870761484,0.23037300329187493,0.669909137660676,0.08494745002661108,0.17227806220350217,0.599749962528758,0.26008112973960507,0.4104483197543841,0.7892318946933292,0.39343377145178005,0.07067025503192537,0.2818784610419677,0.6569178262847509,0.7322960882013007,0.36259456156528536,0.9644437212365516,0.33187859739085235,0.7095827240972956,0.3822357362121709,0.5178732330363008,0.029504441568692474,0.6851273480415079,0.28999840679656286,0.02175843789377052,0.615186693138266,0.8636824226222274,0.996059473435776,0.7004583539810744,0.11258376335302978,0.8776928107049319,0.789355483986041,0.1327140442803958,0.43428934199026314,0.2579127219623225,0.4405788684508777,0.6980580817083364,0.5192346780663568,0.7094118827088477,0.3749953365430978,0.07318842570797368,0.28137954146598576,0.467800000432934,0.4867870796725181,0.009528479439991466,0.4481838544738639,0.030535508917252985,0.6451087110208991,0.5212822154492732,0.3986496499912322,0.5040627381134143,0.942261508199455,0.8617252362163118,0.6724237626167421,0.7865724725768426,0.6066061816463911,0.1328927887095649,0.0019088805213182125,0.8087924854095342,0.2574822525396222,0.7978541929855284,0.6630616495750022,0.5983114760884795,0.8713733394839444,0.38489635363036745,0.005729167152786041,0.9628828885913533,0.11224493161560822,0.6328277941612479,0.12460176906846332,0.26306987435970053,0.9566013510403271,0.9949360965122527,0.6913332340390329,0.3236118226716337,0.03368340108971479,0.9555238115604253,0.6454385222568559,0.9779879681411243,0.7421170115385747,0.5165308783574201,0.6688279771349305,0.4961570335481307,0.8016010288084479,0.8042394346739689,0.9461775273824682,0.8730857184956039,0.35676465878951613,0.2784422251395188,0.7068140021123264,0.1511950305342078,0.7185421339068846,0.6435294670163465,0.3498686919876647,0.5344565599281287,0.5170621202842032],"coloraxis":"coloraxis","symbol":"circle"},"mode":"markers","name":"","scene":"scene","showlegend":false,"x":[0.7039786158996293,1.1247575999221666,1.3644546831949365,0.8585044762329996,0.016555542207250085,0.894487906216282,1.8366608257206738,0.5705844600445928,1.0309551955389045,0.7862231480664867,1.150300383977197,1.7701299292521873,0.2918894647201318,1.50627668909069,0.21170934314951517,1.530399761520989,0.48874204870054294,0.9094567394513122,0.17184605824400023,0.3490825663069428,1.558723914012818,1.0119219184262567,0.9188258355789993,1.7641667162487336,1.0444838949881365,1.6493634726379618,1.4541700537301374,1.500356753595541,0.3658786929834963,0.43055530082748317,1.4903459271684847,1.9609977982712594,1.445668097474075,1.248713324323314,1.3252511322472116,1.3148270186433224,0.052976885227498105,0.17884447509642376,1.6996646669210205,0.2745996379577127,0.05961415713807994,0.8851093046217562,0.4433058143349857,1.6104168532925967,1.5944953429751643,0.3959975677935672,1.687519076890779,1.43501093800638,1.4999065869878696,0.7485132049823933,0.3491734166354947,0.969283522034686,0.729159908135552,1.1647141419635236,0.9135499067326216,0.2425380816097935,0.10690895324367955,1.9975773439368036,0.7312201835406786,0.30570045381183886,0.9418479542210145,1.2934030984762903,1.7835377840204327,0.4158773951135506,1.3256158863775245,1.636484307323454,1.0613626294968008,1.682271541202124,0.9657252818176898,1.8486416283879523,1.1253557622156036,0.9808138393330976,1.6573685444317359,1.9650805411244714,0.28414563105892654,1.5763178342120716,1.4497622954045026,0.8930467681592076,0.5374027016772693,0.6965842641169255,1.9548505735508988,1.1534674164045216,1.2469701542252996,0.49382455567363603,1.055322388173255,0.0990780661833095,1.3874345364796385,1.9361439503609805,1.415086755844581,0.7005127242265308,0.5191669414680933,0.20638142311964147,0.01362277355092889,1.4684109854052232,0.10827439040188613,0.8336776646248563,0.8312286355942904,1.7746160586071573,1.0202057789333012,1.6631707696521192],"y":[0.6581133687560407,0.2059598232872073,1.5280305509488628,2.4871106043375466,1.2652188810718408,2.125893217440301,0.5814695299801603,1.4894887781517099,2.0009352699348004,0.3670353483678307,2.410090115833614,0.1412826380617237,1.3149407609160813,1.5289687535837337,1.637080361872421,2.6576350608335466,0.8508828803207267,2.0236931149032653,2.3727197364146284,0.8668200940665954,0.6946335201727509,1.5481314715002363,0.10303740099780812,2.3692343317537032,1.0314886715754112,1.831380775969921,1.0133434687636702,1.0225419996345562,2.9821540561802333,0.7956029945819754,2.131442811555226,1.552616716661591,0.8487266630397305,0.4212607574481225,2.680275378033593,1.9092352937513275,2.83912241791462,1.871628344636691,1.30424138509437,0.13093092999077782,2.8866090512451543,0.0316244814052169,0.00319075466345764,2.395396791448474,1.5845385799585245,2.356273708307439,2.524309237436822,2.2952110793211595,0.14615716019149727,1.3098200140154996,2.5836560251258254,1.310452795006415,0.6951255969324737,2.2521173388049447,0.46915196084414335,0.32803266143588106,2.4478213134133813,2.4792660715416477,1.0097240418264253,1.8632680356243765,1.725551150123823,1.3126476552582422,2.572983084782658,0.7697709200573989,0.7197906342389929,1.086759086125526,2.9559455229862173,2.2993094805557472,0.29817569306293035,2.5067548664372064,1.1090883528341293,0.013890433172187189,2.9761082670043253,2.3143781993829333,2.3578696480618344,2.573260295195329,2.134417800508438,1.8880682110255897,1.597892137010322,0.29919925828474114,2.7738315461604506,1.9153675286161704,0.8443302923249117,1.7639077356413144,1.2130255843146458,2.6106451330996476,1.477271469547314,0.3034169926997329,1.6479076349234725,2.010228959502956,2.568121009538471,1.542800987018965,1.736401580348672,1.4946839966333338,1.6913963264322187,2.8351955949755925,1.8334733068882647,1.0532831126092401,2.9138886865672613,1.8348297328463075],"z":[3.9746994338845263,1.1531041767321297,3.7721257209044965,3.435725247704429,1.4849809624882644,0.8433808165620937,3.0187295215858265,0.1731870890741889,3.439531465024207,1.3676933895943493,2.0842314448875126,0.8072929445506918,0.09398464960547814,0.34124063750473166,2.65454018895203,1.4978724286733942,1.8462251990454517,1.8104147700048885,2.763236213989999,1.0454161791695467,1.7368864152531902,1.1339833505147126,0.8151931553503373,2.6467422019594244,0.9323809948193373,2.187681259410715,3.2615462770693044,1.0402024282464035,2.2824776291609217,0.023878826392072394,0.5827139618554664,3.767642368288164,0.6014478627301405,1.1190644384366042,3.589770880827844,2.5415275713127468,3.6851720812514333,0.6925986816461163,3.7282635719756807,0.029543983896792803,3.5336941842500944,3.2909891542329124,1.3341723041293,0.8763723963607184,2.261595201743707,2.511648973398692,2.244033784326215,1.0679302038876548,0.04585347815300045,1.2416666541272767,1.9288523128790511,2.459559013636839,3.4301298041395833,2.7628269643512375,2.209297949384515,3.5596869506073285,2.5788763576313816,1.694518918683463,0.9237878419714609,1.1485029415920809,0.753432727347529,3.627018256183013,1.11644059266838,3.683643938150912,2.1881934283986553,3.278642558410879,3.041058790587814,2.848978738421647,0.9786632484930919,1.7741992321252966,1.3756070057083059,2.0515483061608877,3.304907575965217,2.6573674526690385,0.9204442065559317,1.4565265831948317,1.1104947001758814,3.969279923550669,1.1928395855510776,1.318255403856471,0.17584747626631625,2.2953749796641514,1.7904500016861533,3.76144964238721,3.5144509714959424,3.457763661964542,0.5559599026990543,1.829685337081849,3.4192528139456453,2.2216861697268833,0.6860118969296578,0.9912445697156014,2.3416461714357357,0.3530963409796768,0.7768459467184923,1.6899623485325184,3.8146479630528694,2.369911176133034,1.6884249494194834,2.6921695340336247],"type":"scatter3d"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"scene":{"domain":{"x":[0.0,1.0],"y":[0.0,1.0]},"xaxis":{"title":{"text":"x"}},"yaxis":{"title":{"text":"y"}},"zaxis":{"title":{"text":"z"}}},"coloraxis":{"colorbar":{"title":{"text":"color"}},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"legend":{"tracegroupgap":0},"margin":{"t":60}},                        {"responsive": true}                    )                };                            </script>        </div>
</div>
</div>
<p>We note that this yields a plot with similar features to the ones obtained in <a href="https://www.paulogcd.com/blog/posts/1_regressions_julia/">the previous article with Julia</a>. The reason for that is that both obtained plots are done using the plotly library.</p>
<p>For the rest of the section, we are going to limit ourselves to only two regressands, excluding the w variable, since the display will be easier to understand this way :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> numpy.column_stack((x,y))</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> statsmodels.api.add_constant(X)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> statsmodels.api.OLS(z,X)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> model.fit()</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(results.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                      y   R-squared:                       0.030
Model:                            OLS   Adj. R-squared:                  0.010
Method:                 Least Squares   F-statistic:                     1.485
Date:                Fri, 05 Jul 2024   Prob (F-statistic):              0.232
Time:                        14:07:23   Log-Likelihood:                -152.81
No. Observations:                 100   AIC:                             311.6
Df Residuals:                      97   BIC:                             319.4
Df Model:                           2                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
const          1.5915      0.312      5.099      0.000       0.972       2.211
x1             0.0273      0.200      0.136      0.892      -0.370       0.425
x2             0.2292      0.134      1.715      0.090      -0.036       0.494
==============================================================================
Omnibus:                       18.620   Durbin-Watson:                   2.015
Prob(Omnibus):                  0.000   Jarque-Bera (JB):                5.252
Skew:                           0.186   Prob(JB):                       0.0724
Kurtosis:                       1.941   Cond. No.                         6.97
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</code></pre>
</div>
</div>
<p>Now, we need more lines to plot a surface. More specifically, we are going to use plotly.graph_objects and make use of the meshgrid method :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co"># We first store the information of our regression : </span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>intercept, coef1, coef2 <span class="op">=</span> results.params</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="co"># We then create meshgrids for x,y, and z : </span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>x_range <span class="op">=</span> numpy.linspace(x.<span class="bu">min</span>(), x.<span class="bu">max</span>(), <span class="dv">10</span>)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>y_range <span class="op">=</span> numpy.linspace(y.<span class="bu">min</span>(), y.<span class="bu">max</span>(), <span class="dv">10</span>)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>x_grid, y_grid <span class="op">=</span> numpy.meshgrid(x_range, y_range)</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>z_grid <span class="op">=</span> intercept <span class="op">+</span> coef1 <span class="op">*</span> x_grid <span class="op">+</span> coef2 <span class="op">*</span> y_grid</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="co"># We now generate a surface object with the grids we just created</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>surface <span class="op">=</span> plotly.graph_objects.Surface(</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>x_grid, y<span class="op">=</span>y_grid, z<span class="op">=</span>z_grid,</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>    colorscale<span class="op">=</span><span class="st">'Viridis'</span>, opacity<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a><span class="co"># We create a scatter object, to be able to plot it with the surface :</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>scatter <span class="op">=</span> plotly.graph_objects.Scatter3d(</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>x, y<span class="op">=</span>y, z<span class="op">=</span>z,</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>    mode<span class="op">=</span><span class="st">'markers'</span>,</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>    marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">5</span>, color<span class="op">=</span>w, colorscale<span class="op">=</span><span class="st">'Viridis'</span>)</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a><span class="co"># We create a figure object, with the scatter and surface tha we just generated : </span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plotly.graph_objects.Figure(data <span class="op">=</span> [scatter, surface])</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a><span class="co"># We display the figure : </span></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>                <div id="d4b9b0db-982e-4c49-a5b0-82ca44c9989f" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("d4b9b0db-982e-4c49-a5b0-82ca44c9989f")) {                    Plotly.newPlot(                        "d4b9b0db-982e-4c49-a5b0-82ca44c9989f",                        [{"marker":{"color":[0.3451886700592903,0.7350169774962059,0.4624456326191767,0.7476828620333067,0.8740841699875966,0.07330430870761484,0.23037300329187493,0.669909137660676,0.08494745002661108,0.17227806220350217,0.599749962528758,0.26008112973960507,0.4104483197543841,0.7892318946933292,0.39343377145178005,0.07067025503192537,0.2818784610419677,0.6569178262847509,0.7322960882013007,0.36259456156528536,0.9644437212365516,0.33187859739085235,0.7095827240972956,0.3822357362121709,0.5178732330363008,0.029504441568692474,0.6851273480415079,0.28999840679656286,0.02175843789377052,0.615186693138266,0.8636824226222274,0.996059473435776,0.7004583539810744,0.11258376335302978,0.8776928107049319,0.789355483986041,0.1327140442803958,0.43428934199026314,0.2579127219623225,0.4405788684508777,0.6980580817083364,0.5192346780663568,0.7094118827088477,0.3749953365430978,0.07318842570797368,0.28137954146598576,0.467800000432934,0.4867870796725181,0.009528479439991466,0.4481838544738639,0.030535508917252985,0.6451087110208991,0.5212822154492732,0.3986496499912322,0.5040627381134143,0.942261508199455,0.8617252362163118,0.6724237626167421,0.7865724725768426,0.6066061816463911,0.1328927887095649,0.0019088805213182125,0.8087924854095342,0.2574822525396222,0.7978541929855284,0.6630616495750022,0.5983114760884795,0.8713733394839444,0.38489635363036745,0.005729167152786041,0.9628828885913533,0.11224493161560822,0.6328277941612479,0.12460176906846332,0.26306987435970053,0.9566013510403271,0.9949360965122527,0.6913332340390329,0.3236118226716337,0.03368340108971479,0.9555238115604253,0.6454385222568559,0.9779879681411243,0.7421170115385747,0.5165308783574201,0.6688279771349305,0.4961570335481307,0.8016010288084479,0.8042394346739689,0.9461775273824682,0.8730857184956039,0.35676465878951613,0.2784422251395188,0.7068140021123264,0.1511950305342078,0.7185421339068846,0.6435294670163465,0.3498686919876647,0.5344565599281287,0.5170621202842032],"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"size":5},"mode":"markers","x":[0.7039786158996293,1.1247575999221666,1.3644546831949365,0.8585044762329996,0.016555542207250085,0.894487906216282,1.8366608257206738,0.5705844600445928,1.0309551955389045,0.7862231480664867,1.150300383977197,1.7701299292521873,0.2918894647201318,1.50627668909069,0.21170934314951517,1.530399761520989,0.48874204870054294,0.9094567394513122,0.17184605824400023,0.3490825663069428,1.558723914012818,1.0119219184262567,0.9188258355789993,1.7641667162487336,1.0444838949881365,1.6493634726379618,1.4541700537301374,1.500356753595541,0.3658786929834963,0.43055530082748317,1.4903459271684847,1.9609977982712594,1.445668097474075,1.248713324323314,1.3252511322472116,1.3148270186433224,0.052976885227498105,0.17884447509642376,1.6996646669210205,0.2745996379577127,0.05961415713807994,0.8851093046217562,0.4433058143349857,1.6104168532925967,1.5944953429751643,0.3959975677935672,1.687519076890779,1.43501093800638,1.4999065869878696,0.7485132049823933,0.3491734166354947,0.969283522034686,0.729159908135552,1.1647141419635236,0.9135499067326216,0.2425380816097935,0.10690895324367955,1.9975773439368036,0.7312201835406786,0.30570045381183886,0.9418479542210145,1.2934030984762903,1.7835377840204327,0.4158773951135506,1.3256158863775245,1.636484307323454,1.0613626294968008,1.682271541202124,0.9657252818176898,1.8486416283879523,1.1253557622156036,0.9808138393330976,1.6573685444317359,1.9650805411244714,0.28414563105892654,1.5763178342120716,1.4497622954045026,0.8930467681592076,0.5374027016772693,0.6965842641169255,1.9548505735508988,1.1534674164045216,1.2469701542252996,0.49382455567363603,1.055322388173255,0.0990780661833095,1.3874345364796385,1.9361439503609805,1.415086755844581,0.7005127242265308,0.5191669414680933,0.20638142311964147,0.01362277355092889,1.4684109854052232,0.10827439040188613,0.8336776646248563,0.8312286355942904,1.7746160586071573,1.0202057789333012,1.6631707696521192],"y":[0.6581133687560407,0.2059598232872073,1.5280305509488628,2.4871106043375466,1.2652188810718408,2.125893217440301,0.5814695299801603,1.4894887781517099,2.0009352699348004,0.3670353483678307,2.410090115833614,0.1412826380617237,1.3149407609160813,1.5289687535837337,1.637080361872421,2.6576350608335466,0.8508828803207267,2.0236931149032653,2.3727197364146284,0.8668200940665954,0.6946335201727509,1.5481314715002363,0.10303740099780812,2.3692343317537032,1.0314886715754112,1.831380775969921,1.0133434687636702,1.0225419996345562,2.9821540561802333,0.7956029945819754,2.131442811555226,1.552616716661591,0.8487266630397305,0.4212607574481225,2.680275378033593,1.9092352937513275,2.83912241791462,1.871628344636691,1.30424138509437,0.13093092999077782,2.8866090512451543,0.0316244814052169,0.00319075466345764,2.395396791448474,1.5845385799585245,2.356273708307439,2.524309237436822,2.2952110793211595,0.14615716019149727,1.3098200140154996,2.5836560251258254,1.310452795006415,0.6951255969324737,2.2521173388049447,0.46915196084414335,0.32803266143588106,2.4478213134133813,2.4792660715416477,1.0097240418264253,1.8632680356243765,1.725551150123823,1.3126476552582422,2.572983084782658,0.7697709200573989,0.7197906342389929,1.086759086125526,2.9559455229862173,2.2993094805557472,0.29817569306293035,2.5067548664372064,1.1090883528341293,0.013890433172187189,2.9761082670043253,2.3143781993829333,2.3578696480618344,2.573260295195329,2.134417800508438,1.8880682110255897,1.597892137010322,0.29919925828474114,2.7738315461604506,1.9153675286161704,0.8443302923249117,1.7639077356413144,1.2130255843146458,2.6106451330996476,1.477271469547314,0.3034169926997329,1.6479076349234725,2.010228959502956,2.568121009538471,1.542800987018965,1.736401580348672,1.4946839966333338,1.6913963264322187,2.8351955949755925,1.8334733068882647,1.0532831126092401,2.9138886865672613,1.8348297328463075],"z":[3.9746994338845263,1.1531041767321297,3.7721257209044965,3.435725247704429,1.4849809624882644,0.8433808165620937,3.0187295215858265,0.1731870890741889,3.439531465024207,1.3676933895943493,2.0842314448875126,0.8072929445506918,0.09398464960547814,0.34124063750473166,2.65454018895203,1.4978724286733942,1.8462251990454517,1.8104147700048885,2.763236213989999,1.0454161791695467,1.7368864152531902,1.1339833505147126,0.8151931553503373,2.6467422019594244,0.9323809948193373,2.187681259410715,3.2615462770693044,1.0402024282464035,2.2824776291609217,0.023878826392072394,0.5827139618554664,3.767642368288164,0.6014478627301405,1.1190644384366042,3.589770880827844,2.5415275713127468,3.6851720812514333,0.6925986816461163,3.7282635719756807,0.029543983896792803,3.5336941842500944,3.2909891542329124,1.3341723041293,0.8763723963607184,2.261595201743707,2.511648973398692,2.244033784326215,1.0679302038876548,0.04585347815300045,1.2416666541272767,1.9288523128790511,2.459559013636839,3.4301298041395833,2.7628269643512375,2.209297949384515,3.5596869506073285,2.5788763576313816,1.694518918683463,0.9237878419714609,1.1485029415920809,0.753432727347529,3.627018256183013,1.11644059266838,3.683643938150912,2.1881934283986553,3.278642558410879,3.041058790587814,2.848978738421647,0.9786632484930919,1.7741992321252966,1.3756070057083059,2.0515483061608877,3.304907575965217,2.6573674526690385,0.9204442065559317,1.4565265831948317,1.1104947001758814,3.969279923550669,1.1928395855510776,1.318255403856471,0.17584747626631625,2.2953749796641514,1.7904500016861533,3.76144964238721,3.5144509714959424,3.457763661964542,0.5559599026990543,1.829685337081849,3.4192528139456453,2.2216861697268833,0.6860118969296578,0.9912445697156014,2.3416461714357357,0.3530963409796768,0.7768459467184923,1.6899623485325184,3.8146479630528694,2.369911176133034,1.6884249494194834,2.6921695340336247],"type":"scatter3d"},{"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"opacity":0.5,"x":[[0.01362277355092889,0.23406217026047052,0.45450156697001215,0.6749409636795538,0.8953803603890954,1.115819757098637,1.3362591538081787,1.5566985505177202,1.777137947227262,1.9975773439368036],[0.01362277355092889,0.23406217026047052,0.45450156697001215,0.6749409636795538,0.8953803603890954,1.115819757098637,1.3362591538081787,1.5566985505177202,1.777137947227262,1.9975773439368036],[0.01362277355092889,0.23406217026047052,0.45450156697001215,0.6749409636795538,0.8953803603890954,1.115819757098637,1.3362591538081787,1.5566985505177202,1.777137947227262,1.9975773439368036],[0.01362277355092889,0.23406217026047052,0.45450156697001215,0.6749409636795538,0.8953803603890954,1.115819757098637,1.3362591538081787,1.5566985505177202,1.777137947227262,1.9975773439368036],[0.01362277355092889,0.23406217026047052,0.45450156697001215,0.6749409636795538,0.8953803603890954,1.115819757098637,1.3362591538081787,1.5566985505177202,1.777137947227262,1.9975773439368036],[0.01362277355092889,0.23406217026047052,0.45450156697001215,0.6749409636795538,0.8953803603890954,1.115819757098637,1.3362591538081787,1.5566985505177202,1.777137947227262,1.9975773439368036],[0.01362277355092889,0.23406217026047052,0.45450156697001215,0.6749409636795538,0.8953803603890954,1.115819757098637,1.3362591538081787,1.5566985505177202,1.777137947227262,1.9975773439368036],[0.01362277355092889,0.23406217026047052,0.45450156697001215,0.6749409636795538,0.8953803603890954,1.115819757098637,1.3362591538081787,1.5566985505177202,1.777137947227262,1.9975773439368036],[0.01362277355092889,0.23406217026047052,0.45450156697001215,0.6749409636795538,0.8953803603890954,1.115819757098637,1.3362591538081787,1.5566985505177202,1.777137947227262,1.9975773439368036],[0.01362277355092889,0.23406217026047052,0.45450156697001215,0.6749409636795538,0.8953803603890954,1.115819757098637,1.3362591538081787,1.5566985505177202,1.777137947227262,1.9975773439368036]],"y":[[0.00319075466345764,0.00319075466345764,0.00319075466345764,0.00319075466345764,0.00319075466345764,0.00319075466345764,0.00319075466345764,0.00319075466345764,0.00319075466345764,0.00319075466345764],[0.3341866770542105,0.3341866770542105,0.3341866770542105,0.3341866770542105,0.3341866770542105,0.3341866770542105,0.3341866770542105,0.3341866770542105,0.3341866770542105,0.3341866770542105],[0.6651825994449634,0.6651825994449634,0.6651825994449634,0.6651825994449634,0.6651825994449634,0.6651825994449634,0.6651825994449634,0.6651825994449634,0.6651825994449634,0.6651825994449634],[0.9961785218357163,0.9961785218357163,0.9961785218357163,0.9961785218357163,0.9961785218357163,0.9961785218357163,0.9961785218357163,0.9961785218357163,0.9961785218357163,0.9961785218357163],[1.3271744442264692,1.3271744442264692,1.3271744442264692,1.3271744442264692,1.3271744442264692,1.3271744442264692,1.3271744442264692,1.3271744442264692,1.3271744442264692,1.3271744442264692],[1.658170366617222,1.658170366617222,1.658170366617222,1.658170366617222,1.658170366617222,1.658170366617222,1.658170366617222,1.658170366617222,1.658170366617222,1.658170366617222],[1.9891662890079749,1.9891662890079749,1.9891662890079749,1.9891662890079749,1.9891662890079749,1.9891662890079749,1.9891662890079749,1.9891662890079749,1.9891662890079749,1.9891662890079749],[2.3201622113987277,2.3201622113987277,2.3201622113987277,2.3201622113987277,2.3201622113987277,2.3201622113987277,2.3201622113987277,2.3201622113987277,2.3201622113987277,2.3201622113987277],[2.6511581337894805,2.6511581337894805,2.6511581337894805,2.6511581337894805,2.6511581337894805,2.6511581337894805,2.6511581337894805,2.6511581337894805,2.6511581337894805,2.6511581337894805],[2.9821540561802333,2.9821540561802333,2.9821540561802333,2.9821540561802333,2.9821540561802333,2.9821540561802333,2.9821540561802333,2.9821540561802333,2.9821540561802333,2.9821540561802333]],"z":[[1.5926178447050627,1.598629839103751,1.604641833502439,1.6106538279011273,1.6166658222998154,1.6226778166985036,1.6286898110971917,1.63470180549588,1.640713799894568,1.6467257942932563],[1.6684836959058822,1.6744956903045705,1.6805076847032585,1.6865196791019468,1.6925316735006348,1.698543667899323,1.7045556622980111,1.7105676566966994,1.7165796510953875,1.7225916454940757],[1.7443495471067014,1.7503615415053897,1.7563735359040777,1.762385530302766,1.768397524701454,1.7744095191001423,1.7804215134988304,1.7864335078975186,1.7924455022962067,1.798457496694895],[1.8202153983075209,1.8262273927062092,1.8322393871048972,1.8382513815035855,1.8442633759022735,1.8502753703009618,1.8562873646996498,1.862299359098338,1.8683113534970262,1.8743233478957144],[1.8960812495083401,1.9020932439070284,1.9081052383057164,1.9141172327044047,1.9201292271030928,1.926141221501781,1.932153215900469,1.9381652102991573,1.9441772046978454,1.9501891990965337],[1.9719471007091596,1.9779590951078478,1.983971089506536,1.9899830839052242,1.9959950783039122,2.0020070727026003,2.0080190671012885,2.014031061499977,2.0200430558986646,2.026055050297353],[2.047812951909979,2.053824946308667,2.0598369407073553,2.0658489351060436,2.0718609295047314,2.0778729239034197,2.083884918302108,2.0898969127007962,2.095908907099484,2.1019209014981723],[2.1236788031107983,2.1296907975094865,2.1357027919081744,2.1417147863068626,2.147726780705551,2.153738775104239,2.159750769502927,2.1657627639016153,2.1717747583003035,2.177786752698992],[2.1995446543116177,2.2055566487103055,2.211568643108994,2.217580637507682,2.22359263190637,2.2296046263050586,2.2356166207037464,2.2416286151024347,2.247640609501123,2.253652603899811],[2.2754105055124367,2.281422499911125,2.2874344943098133,2.2934464887085015,2.2994584831071894,2.3054704775058776,2.311482471904566,2.317494466303254,2.323506460701942,2.3295184551006303]],"type":"surface"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}}},                        {"responsive": true}                    )                };                            </script>        </div>
</div>
</div>
<p>This looks satisfactory. I even manage to plot the points with the surface of the regression in the 3D plot.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>